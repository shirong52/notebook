---


---

<h1 id="超几何空间中大型语言模型的微调">超几何空间中大型语言模型的微调</h1>
<h2 id="研究目标与实际意义">研究目标与实际意义</h2>
<h3 id="研究目标">研究目标</h3>
<ul>
<li>探究大型语言模型(LLMs)中token嵌入空间的非欧几里得特性，特别是其超几何性质</li>
<li>基于对token嵌入空间特性的分析，开发一种在超几何空间中有效微调LLMs的方法</li>
<li>提出HypLoRA，一种能直接在超几何流形上进行低秩适配的参数高效微调方法</li>
</ul>
<h3 id="实际问题及意义">实际问题及意义</h3>
<ul>
<li>现有LLMs通常在欧几里得空间中嵌入token，但这可能不是表示复杂、层次化数据结构的最佳选择</li>
<li>语言中的词汇天然具有树状层次结构，如抽象概念(“水果”)位于层次顶部，具体术语(“苹果”“香蕉”)位于底层</li>
<li>超几何空间由于其负曲率特性，特别适合表示树状数据，其指数级体积增长使其能高效嵌入层次结构</li>
<li>理解LLMs的超几何特性可以更好地设计微调方法，尤其是对推理任务，从而提高模型性能</li>
</ul>
<h2 id="方法创新与技术细节">方法创新与技术细节</h2>
<h3 id="对llms-token嵌入的超几何分析">对LLMs token嵌入的超几何分析</h3>
<p>研究团队从全局和局部两个层面分析了LLMs的token嵌入：</p>
<ol>
<li>
<p><strong>全局token统计分析</strong>：</p>
<ul>
<li><strong>频率分布</strong>：token频率遵循幂律分布，幂律指数约为γ≈1.9</li>
<li><strong>空间排布</strong>：高频token(抽象概念)倾向于位于嵌入空间原点附近，低频token(具体术语)位于远离原点处</li>
<li><strong>分层表示</strong>：根据token范数(norm)可将词汇分类，如0.3~0.4范围包含"to", “in"等常见功能词，0.6~0.7范围包含"dog”, "apple"等具体名词</li>
</ul>
</li>
<li>
<p><strong>局部δ-超几何性分析</strong>：</p>
<ul>
<li>使用Gromov的δ-超几何性度量评估token嵌入空间的树状结构程度</li>
<li>δ值越小表示空间越接近完美树形结构，通过四点条件计算：<br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>c</mi><msub><mo stretchy="false">]</mo><mi>w</mi></msub><mo>≥</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><msub><mo stretchy="false">]</mo><mi>w</mi></msub><mo separator="true">,</mo><mo stretchy="false">[</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><msub><mo stretchy="false">]</mo><mi>w</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>δ</mi></mrow><annotation encoding="application/x-tex">[a,c]_w \geq \min([a,b]_w,[b,c]_w) - \delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">min</span><span class="mopen">([</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">b</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">[</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03785em;">δ</span></span></span></span></span></li>
<li>实验结果显示LLMs的token嵌入具有显著的超几何特性(δ值在0.06~0.12之间)，远低于随机图(0.62)和球面空间(0.99)</li>
</ul>
</li>
</ol>
<h3 id="hyplora方法设计">HypLoRA方法设计</h3>
<p>面对传统Tangent空间变换方法在LLMs中应用的技术挑战，作者提出了HypLoRA(Hyperbolic Low-Rank Adaptation)方法：</p>
<ol>
<li>
<p><strong>技术挑战</strong>：</p>
<ul>
<li>直接使用经典的切空间方法会导致指数映射和对数映射相互抵消，无法有效保留超几何特性</li>
<li>当输入来自欧几里得空间并需要返回欧几里得表示时，简单的超几何变换会简化回原始LoRA: <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>L</mi><mi>o</mi><mi>R</mi><mi>A</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><msub><mi>x</mi><mi>E</mi></msub><mo>+</mo><msubsup><mrow><mi>log</mi><mo>⁡</mo></mrow><mi>o</mi><mi>K</mi></msubsup><mo stretchy="false">(</mo><msubsup><mrow><mi>exp</mi><mo>⁡</mo></mrow><mi>o</mi><mi>K</mi></msubsup><mo stretchy="false">(</mo><mi>B</mi><mi>A</mi><msub><mi>x</mi><mi>E</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><msub><mi>x</mi><mi>E</mi></msub><mo>+</mo><mi>B</mi><mi>A</mi><msub><mi>x</mi><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">W_{LoRA}(x_E) = Wx_E + \log^K_o(\exp^K_o(BAx_E)) = Wx_E + BAx_E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.17567em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.925671em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span><span class="" style="top: -3.14734em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop">exp</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>直接Lorentz低秩变换(LLR)</strong>：</p>
<ul>
<li>不使用切空间，而是直接在超几何流形上进行低秩适配：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>E</mi></msub><mo>=</mo><msub><mi>W</mi><mrow><mi>L</mi><mi>o</mi><mi>R</mi><mi>A</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><msub><mi>x</mi><mi>E</mi></msub><mo>+</mo><msubsup><mrow><mi>log</mi><mo>⁡</mo></mrow><mi>o</mi><mi>K</mi></msubsup><mo stretchy="false">(</mo><mi>L</mi><mi>L</mi><mi>R</mi><mo stretchy="false">(</mo><mi>B</mi><mi>A</mi><mo separator="true">,</mo><msubsup><mrow><mi>exp</mi><mo>⁡</mo></mrow><mi>o</mi><mi>K</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
z_E = W_{LoRA}(x_E) = Wx_E + \log^K_o(LLR(BA, \exp^K_o(x_E)))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.17567em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.925671em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span><span class="" style="top: -3.14734em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop">exp</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)))</span></span></span></span></span></span></li>
<li>LLR变换定义为：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mi>L</mi><mi>R</mi><mo stretchy="false">(</mo><mi>B</mi><mi>A</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>H</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msqrt><mrow><mi mathvariant="normal">∥</mi><mi>B</mi><msubsup><mi>y</mi><mi>H</mi><mo>∗</mo></msubsup><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>K</mi></mrow></msqrt><mo separator="true">,</mo><mi>B</mi><msubsup><mi>y</mi><mi>H</mi><mo>∗</mo></msubsup><mo stretchy="false">)</mo><msub><mi>y</mi><mi>H</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msqrt><mrow><mi mathvariant="normal">∥</mi><mi>A</mi><msubsup><mi>x</mi><mi>H</mi><mo>∗</mo></msubsup><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>K</mi></mrow></msqrt><mo separator="true">,</mo><mi>A</mi><msubsup><mi>x</mi><mi>H</mi><mo>∗</mo></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
LLR(BA,x_H) = (\sqrt{\|By_H^*\|^2_2+K}, By_H^*)
y_H = (\sqrt{\|Ax_H^*\|^2_2+K}, Ax_H^*)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.84em; vertical-align: -0.554936em;"></span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.28506em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.670496em;"><span class="" style="top: -2.40647em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.795908em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span></span></span><span class="" style="top: -3.24506em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"><svg width="400em" height="1.8800000000000001em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.554936em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.84em; vertical-align: -0.554936em;"></span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.28506em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord">∥</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.670496em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.795908em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span></span></span><span class="" style="top: -3.24506em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"><svg width="400em" height="1.8800000000000001em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.554936em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.08125em;">H</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></li>
<li>两种变换策略：(1)只修改类空维度(Lorentz旋转) (2)同时影响类时和类空维度(Lorentz推进)</li>
</ul>
</li>
<li>
<p><strong>理论分析</strong>：</p>
<ul>
<li>通过泰勒展开分析，HypLoRA引入了与token范数相关的高阶项：<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>Q</mi><mrow><mi>H</mi><mi>y</mi><mi>p</mi></mrow></msub><mo>−</mo><mi mathvariant="normal">Δ</mi><msub><mi>Q</mi><mrow><mi>L</mi><mi>o</mi><mi>R</mi><mi>A</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∥</mi><mi>x</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><mrow><mn>6</mn><msup><mi>R</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi>B</mi><mi>A</mi><mo stretchy="false">)</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\Delta Q_{Hyp} - \Delta Q_{LoRA} = \frac{\|x\|^2}{6R^2}(BA)x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">Hy</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.45392em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10892em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.746314em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mathnormal mtight">x</span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord mathnormal">x</span></span></span></span></span></li>
<li>这些高阶项对于范数较大的token(更具体的概念)影响更显著，使模型更好地捕捉复杂的层次关系</li>
</ul>
</li>
</ol>
<h3 id="实验设置">实验设置</h3>
<ol>
<li>
<p><strong>数据集</strong>：</p>
<ul>
<li>微调训练集：由GSM8K、MAWPS、MAWPS-single和1000个AQuA示例组成的Math-10K数据集</li>
<li>测试数据集：GSM8K、AQuA、MAWPS和SVAMP，测试集与训练集无重叠</li>
</ul>
</li>
<li>
<p><strong>模型对比</strong>：</p>
<ul>
<li>基础模型：LLaMA-7B、LLaMA-13B、Gemma-7B和LLaMA3-8B</li>
<li>微调方法对比：Prefix-Tuning、Series Adapter、LoRA、Parallel Adapter和DoRA</li>
</ul>
</li>
<li>
<p><strong>实现细节</strong>：</p>
<ul>
<li>使用指数映射前先对输入进行L2归一化，然后用可学习的范数缩放因子重新缩放</li>
<li>超参数：曲率搜索范围为{0.1, 0.5, 1.0, 2.0}</li>
<li>LoRA插入点：多头注意力和MLP层</li>
</ul>
</li>
</ol>
<h2 id="实验验证与结果">实验验证与结果</h2>
<h3 id="主要实验结果">主要实验结果</h3>
<p>实验结果显示HypLoRA在算术推理任务上表现优异，特别是在复杂推理问题上：</p>
<ol>
<li>
<p><strong>整体性能</strong>：</p>
<ul>
<li>HypLoRA在各种基础模型上都优于基线方法，在LLaMA3-8B上整体性能提高2.3%，在Gemma-7B上提高3.9%</li>
<li>特别在复杂数据集上表现突出，如在AQuA数据集上提升高达13.0%，在GSM8K上提高4.8%(Gemma-7B)</li>
<li>这些显著提升反映了引入超几何空间的优势，其固有几何特性更适合捕捉复杂、层次化结构数据</li>
</ul>
</li>
<li>
<p><strong>与DoRA对比</strong>：</p>
<ul>
<li>DoRA由于计算复杂度高导致某些评估超时(如LLaMA-13B的GSM8K评估)</li>
<li>HypLoRA在完成的评估中表现与DoRA相当或更好，且计算开销更低</li>
<li>在MAWPS数据集上，HypLoRA的改进不如其他数据集明显，有时甚至低于基线结果，可能是由于在微调中使用相同曲率所致</li>
</ul>
</li>
</ol>
<h3 id="消融实验与参数分析">消融实验与参数分析</h3>
<ol>
<li>
<p><strong>消融研究</strong>：</p>
<ul>
<li>将HypLoRA与切空间方法进行对比，验证直接Lorentz低秩变换的有效性</li>
<li>切空间方法因引入缩放步骤显示出比原始LoRA的改进，但仍不如HypLoRA</li>
<li>两种变换策略(Lorentz旋转和Lorentz推进)获得了相似的性能</li>
</ul>
</li>
<li>
<p><strong>曲率影响分析</strong>：</p>
<ul>
<li>在Gemma 7B模型上测试了不同曲率值(0.1, 0.5, 1.0, 2.0)的影响</li>
<li>模型性能在不同曲率设置下相对稳定，最终选择1.0作为最佳值</li>
<li>未来考虑探索数据驱动的自适应曲率方法</li>
</ul>
</li>
<li>
<p><strong>推理效率</strong>：</p>
<ul>
<li>HypLoRA的理论时间复杂度与LoRA相同(O(r·(d+k)))</li>
<li>实际推理中，由于指数映射和对数映射等操作，HypLoRA会引入额外计算开销</li>
<li>尽管如此，HypLoRA在运行时间和整体效率方面仍优于DoRA</li>
</ul>
</li>
</ol>
<h3 id="案例研究">案例研究</h3>
<p>HypLoRA能更准确地理解问题语义并进行复杂推理。案例表明：</p>
<ol>
<li>
<p><strong>案例1 - 时间分配问题</strong>：</p>
<ul>
<li>LoRA未能正确理解计算任务的本质，而HypLoRA正确解释了问题，识别三周时间框架并适当分配所需时间</li>
</ul>
</li>
<li>
<p><strong>案例2 - 数学平均分计算</strong>：</p>
<ul>
<li>LoRA错误计算测试分数总和为380而非正确的400，导致平均分错误</li>
<li>HypLoRA准确计算并得到正确结果</li>
</ul>
</li>
<li>
<p><strong>案例3 - 多步骤算术推理</strong>：</p>
<ul>
<li>LoRA在计算11,600-9,800时出错，导致关于卡车载重量的结论错误</li>
<li>HypLoRA正确执行计算并得到准确答案</li>
</ul>
</li>
</ol>
<p>这些案例展示了超几何空间如何增强模型理解语义和执行复杂推理的能力，特别是在处理具有层次结构的问题时。</p>
<h2 id="未来研究方向与挑战">未来研究方向与挑战</h2>
<h3 id="值得探索的问题">值得探索的问题</h3>
<ol>
<li>
<p><strong>自适应曲率</strong>：</p>
<ul>
<li>开发能够根据不同提示或任务自适应调整曲率的方法，而非使用统一的曲率值</li>
<li>探索数据驱动的曲率选择机制，使模型能够更好地适应不同数据集的特性</li>
</ul>
</li>
<li>
<p><strong>更高效的超几何操作</strong>：</p>
<ul>
<li>研发更高效的指数和对数映射实现方法，减少计算开销</li>
<li>探索优化超几何空间中的操作，使其在大型模型中更实用</li>
</ul>
</li>
<li>
<p><strong>扩展到其他任务</strong>：</p>
<ul>
<li>将超几何微调扩展到除算术推理外的其他任务，如逻辑推理、文本生成等</li>
<li>探索超几何方法在多模态任务中的应用潜力</li>
</ul>
</li>
<li>
<p><strong>超几何性质与模型能力关系研究</strong>：</p>
<ul>
<li>深入研究token嵌入的超几何特性与模型推理能力之间的关系</li>
<li>探索如何基于数据特性设计最优的几何结构</li>
</ul>
</li>
</ol>
<h3 id="技术机会">技术机会</h3>
<ol>
<li>
<p><strong>超几何预训练LLMs</strong>：</p>
<ul>
<li>开发完全在超几何空间中训练的LLMs，而非仅在微调阶段使用超几何空间</li>
<li>研究超几何和欧几里得混合架构，结合两种几何的优势</li>
</ul>
</li>
<li>
<p><strong>超几何LoRA变体</strong>：</p>
<ul>
<li>将HypLoRA与其他LoRA变体(如LoRA+、AdaLoRA等)结合，发挥互补优势</li>
<li>探索量化技术与超几何微调的结合，进一步提高效率</li>
</ul>
</li>
<li>
<p><strong>自适应超几何结构</strong>：</p>
<ul>
<li>开发能够自适应学习数据最优表示几何的方法</li>
<li>探索多曲率超几何空间在表示复杂结构方面的潜力</li>
</ul>
</li>
</ol>
<h2 id="不足与局限性">不足与局限性</h2>
<h3 id="论文存在的局限">论文存在的局限</h3>
<ol>
<li>
<p><strong>统一曲率的限制</strong>：</p>
<ul>
<li>在微调过程中对所有提示使用相同的曲率，可能不适用于不同数据集</li>
<li>这可能是HypLoRA在MAWPS数据集上表现不如其他数据集的原因</li>
</ul>
</li>
<li>
<p><strong>计算开销</strong>：</p>
<ul>
<li>指数和对数映射引入额外计算开销，增加了推理时间</li>
<li>在转换欧几里得空间和超几何空间时的计算复杂性</li>
</ul>
</li>
<li>
<p><strong>实验范围</strong>：</p>
<ul>
<li>主要在算术推理任务上进行评估，缺乏对其他类型任务的广泛测试</li>
<li>未探索超几何特性在更复杂语言理解任务中的效果</li>
</ul>
</li>
</ol>
<h3 id="需要进一步验证的问题">需要进一步验证的问题</h3>
<ol>
<li>
<p><strong>超几何特性与推理能力关系</strong>：</p>
<ul>
<li>需要进一步验证token嵌入的超几何特性与模型推理能力之间的因果关系</li>
<li>探究超几何结构如何具体影响模型的推理过程</li>
</ul>
</li>
<li>
<p><strong>扩展性验证</strong>：</p>
<ul>
<li>在更大规模模型和更多任务上验证方法的有效性和扩展性</li>
<li>探索在不同架构(如Transformer变体)中的适用性</li>
</ul>
</li>
<li>
<p><strong>最优曲率设置</strong>：</p>
<ul>
<li>探索确定最优曲率值的方法，以及曲率如何随任务复杂度变化</li>
<li>研究不同任务可能需要的不同曲率特性</li>
</ul>
</li>
</ol>
<h2 id="实用创新与应用启示">实用创新与应用启示</h2>
<h3 id="值得学习的创新点">值得学习的创新点</h3>
<ol>
<li>
<p><strong>几何视角分析LLMs</strong>：</p>
<ul>
<li>从几何角度分析LLMs token嵌入空间，揭示其内在超几何特性</li>
<li>这提供了理解和改进LLMs的新视角，超越了传统的统计和神经网络分析</li>
</ul>
</li>
<li>
<p><strong>直接超几何流形操作</strong>：</p>
<ul>
<li>不依赖传统的切空间方法，而是直接在超几何流形上进行变换</li>
<li>通过LLR变换避免了指数映射和对数映射的抵消效应</li>
</ul>
</li>
<li>
<p><strong>理论与实践相结合</strong>：</p>
<ul>
<li>结合理论分析(如Taylor展开)和实际应用，解释超几何空间的优势</li>
<li>建立了token范数、层次结构和模型性能之间的联系</li>
</ul>
</li>
<li>
<p><strong>参数高效设计</strong>：</p>
<ul>
<li>保持了LoRA的参数效率优势，同时引入超几何几何特性</li>
<li>提供了一个实用的超几何微调框架，无需重新训练模型</li>
</ul>
</li>
</ol>
<h3 id="实用启示">实用启示</h3>
<ol>
<li>
<p><strong>几何考量的重要性</strong>：</p>
<ul>
<li>在设计和微调LLMs时，应考虑数据的内在几何结构</li>
<li>为不同任务选择合适的几何表示可能比简单增加模型参数更有效</li>
</ul>
</li>
<li>
<p><strong>复杂推理任务的解决方案</strong>：</p>
<ul>
<li>对于需要多步推理和复杂层次理解的任务，超几何方法可能特别有效</li>
<li>在算术推理、逻辑推理等领域有潜在应用价值</li>
</ul>
</li>
<li>
<p><strong>高效微调策略</strong>：</p>
<ul>
<li>HypLoRA可作为一种有效微调策略，特别适用于资源有限情况</li>
<li>在保持原有模型架构的同时，通过几何改进提升性能</li>
</ul>
</li>
<li>
<p><strong>处理长尾分布数据</strong>：</p>
<ul>
<li>超几何空间的指数体积增长特性使其特别适合处理长尾分布数据</li>
<li>对于具有明显层次结构的数据集可能特别有效</li>
</ul>
</li>
</ol>
<h3 id="需要补充的背景知识">需要补充的背景知识</h3>
<ol>
<li>
<p><strong>超几何几何基础</strong>：</p>
<ul>
<li>了解Lorentz模型、Poincaré球模型等超几何空间表示</li>
<li>掌握超几何空间中的距离计算、指数映射和对数映射等基本操作</li>
</ul>
</li>
<li>
<p><strong>低秩适配(LoRA)原理</strong>：</p>
<ul>
<li>理解LoRA的基本原理及其在LLMs微调中的应用</li>
<li>掌握参数高效微调(PEFT)的核心概念</li>
</ul>
</li>
<li>
<p><strong>大型语言模型架构</strong>：</p>
<ul>
<li>了解Transformer架构及其在LLMs中的应用</li>
<li>掌握注意力机制、MLP层等组件的功能和作用</li>
</ul>
</li>
<li>
<p><strong>幂律分布与层次结构</strong>：</p>
<ul>
<li>理解幂律分布在自然语言中的表现</li>
<li>掌握如何分析和表示层次结构数据</li>
</ul>
</li>
</ol>
<p>HypLoRA为大型语言模型的微调提供了一个新的视角，通过将超几何几何引入微调过程，利用语言的内在树状结构特性，显著提高了模型在复杂推理任务上的表现。这项工作不仅在技术上创新，还为未来几何感知的语言模型设计开辟了新方向。</p>
<h1 id="全局和局部蕴含学习在自然世界图像中的应用">全局和局部蕴含学习在自然世界图像中的应用</h1>
<h2 id="研究目标与实际意义-1">研究目标与实际意义</h2>
<h3 id="研究目标-1">研究目标</h3>
<ul>
<li>提出径向跨模态嵌入(Radial Cross-Modal Embeddings, RCME)框架，使视觉-语言模型能够显式建模具有传递性的蕴含关系</li>
<li>解决现有蕴含学习方法未能有效模拟蕴含关系传递性的问题，这种传递性建立了表示空间中的序关系和语义关系</li>
<li>开发一个能够表示生命树(Tree of Life)层次结构的视觉-语言基础模型，优化概念的偏序关系</li>
</ul>
<h3 id="实际问题与意义">实际问题与意义</h3>
<ul>
<li>地球上大部分物种尚未被描述，将标本标记到物种层级既昂贵又需要专业知识</li>
<li>分类系统和标签会随时间变化，可能因误标或新物种发现而调整</li>
<li>分层表示可以实现在任何分类层级的推理，帮助将标本分组并路由给具有适当专业知识的生物学家</li>
<li>能够帮助理解生命树中某些物种的演化</li>
<li>为不同专业水平的终端用户提供在任何分类层级进行分类的能力</li>
</ul>
<h2 id="方法创新与技术细节-1">方法创新与技术细节</h2>
<h3 id="蕴含学习的传递性问题">蕴含学习的传递性问题</h3>
<p>论文首先分析了现有蕴含学习方法的局限性：</p>
<ol>
<li>
<p><strong>传统蕴含锥定义问题</strong>：</p>
<ul>
<li>传统方法需要显式定义张角(aperture angles)来构建嵌入子区域的同心锥</li>
<li>这些方法受限于锥结构的最优性可能因应用而异</li>
<li>近期Alper等人[1]提出的径向嵌入消除了目标函数对蕴含锥的依赖，但未能强制执行概念的偏序关系</li>
</ul>
</li>
<li>
<p><strong>传递性的重要性</strong>：</p>
<ul>
<li>如果"哺乳纲(Mammalia)"由"脊索动物门(Chordata)"蕴含，且"食肉目(Carnivora)“由"哺乳纲"蕴含，那么"脊索动物门"应蕴含"食肉目”</li>
<li>传递性是表示空间的重要性质，控制基于语义粒度的概念之间的距离关系</li>
<li>更细粒度的概念应投影到距离粗粒度概念更远的位置</li>
</ul>
</li>
</ol>
<h3 id="rcme框架的核心思想">RCME框架的核心思想</h3>
<p>论文提出的RCME框架包含以下核心组件：</p>
<ol>
<li>
<p><strong>引理1：传递性强制蕴含的特性</strong></p>
<ul>
<li>在传递性强制蕴含中，细粒度概念会逐渐投影到：
<ol>
<li>远离蕴含根(entailment root)</li>
<li>更小的子区域</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>全局蕴含学习</strong>：</p>
<ul>
<li>定义局部蕴含：当<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">T^i_{j+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span>被<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>j</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">T^i_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span></span></span></span></span>在一定程度上完全蕴含时</li>
<li>定义全局蕴含：当方程<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo>≥</mo><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mi>j</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mi>j</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(T^i_{j-1}, T^i_{j+1}) ≥ S(T^i_{j-1}, T^i_j) · S(T^i_j, T^i_{j+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.21944em; vertical-align: -0.394772em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.44134em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.394772em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>对所有可能的子层次结构成立时</li>
<li>提出基于边际的损失函数来实现全局蕴含：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>G</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">;</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">Ξ</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo>−</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mi>j</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>T</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>T</mi><mi>j</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
L_{GE}(i,j;α) = max(0, Ξ(T^i_{j-1}, T^i_{j+1}) - 
              arccos(S(T^i_j, T^i_{j+1}) · S(T^i_{j-1}, T^i_j)) + α)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">GE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.25777em; vertical-align: -0.383108em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Ξ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.25777em; vertical-align: -0.383108em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">rccos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span></span></span></span></span></span></li>
<li>其中α是边际参数，设为π/2</li>
</ul>
</li>
<li>
<p><strong>局部和全局蕴含的结合</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>G</mi><mi>L</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">;</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∗</mo><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>L</mi><mrow><mi>G</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mo separator="true">;</mo><mi>α</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo><mo>∗</mo><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>L</mi><mrow><mi>L</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mo separator="true">,</mo><mi>K</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
L_{GLE}(i,k;α) = (1/(N-1)) * Σ_{p=1}^{N-1} L_{GE}(i,p;α) + 
                (1/N) * Σ_{p=0}^{N-1} L_{LE}(i,p,K[p])
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1/</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.28388em; vertical-align: -0.392547em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.44356em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.392547em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">GE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">p</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.28388em; vertical-align: -0.392547em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.44356em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.392547em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">K</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">])</span></span></span></span></span></span></p>
<ul>
<li>L_LE是局部蕴含损失，K[p]是每个层级的负样本集</li>
</ul>
</li>
<li>
<p><strong>跨模态对齐</strong>：</p>
<ul>
<li>同时微调视觉和文本编码器，通过跨模态对齐损失：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>C</mi><mi>M</mi><mi>A</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msup><mi>e</mi><mo stretchy="false">⟨</mo></msup><msubsup><mi>T</mi><mi>N</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msup><mi>I</mi><mi>i</mi></msup><mo stretchy="false">⟩</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></msubsup><msup><mi>e</mi><mo stretchy="false">⟨</mo></msup><msubsup><mi>T</mi><mi>N</mi><mi>m</mi></msubsup><mo separator="true">,</mo><msup><mi>I</mi><mi>m</mi></msup><mo stretchy="false">⟩</mo><mo>+</mo><msup><mi>e</mi><mo stretchy="false">⟨</mo></msup><msubsup><mi>T</mi><mi>N</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msup><mi>I</mi><mi>i</mi></msup><mo stretchy="false">⟩</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
L_{CMA}(i) = -log(e^⟨T^i_N, I^i⟩ / (Σ_{m=1}^B e^⟨T^m_N, I^m⟩ + e^⟨T^i_N, I^i⟩))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">CM</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">⟨</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">⟨</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">⟨</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -2.453em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">⟩))</span></span></span></span></span></span></li>
<li>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>I</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">I^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>是与<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>N</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">T^i_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09999em; vertical-align: -0.275331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.42467em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示相同物种的图像嵌入</li>
</ul>
</li>
<li>
<p><strong>最终的RCME损失函数</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mrow><mi>R</mi><mi>C</mi><mi>M</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">;</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>L</mi><mrow><mi>G</mi><mi>L</mi><mi>E</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo separator="true">;</mo><mi>α</mi><mo stretchy="false">)</mo><mo>+</mo><mi>β</mi><mo separator="true">⋅</mo><msub><mi>L</mi><mrow><mi>C</mi><mi>M</mi><mi>A</mi></mrow></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
L_{RCME}(i,k;α) = L_{GLE}(i,k;α) + β·L_{CMA}(i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">RCME</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.05278em;">β</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">CM</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>难负样本挖掘</strong>：</p>
<ul>
<li>提出一种难负样本挖掘技术，用于局部蕴含目标</li>
<li>通过匹配正样本所有先前层级的分类标签来创建难负样本</li>
<li>随机采样父节点的"兄弟"，然后随机采样该兄弟的子节点，创建最终负样本</li>
</ul>
</li>
</ol>
<h3 id="实验设置-1">实验设置</h3>
<ol>
<li>
<p><strong>模型实现</strong>：</p>
<ul>
<li>基于OpenCLIP的ViT-B/16架构</li>
<li>两种变体：一种使用OpenCLIP初始化，另一种从BioCLIP检查点微调</li>
<li>使用"Eukarya"作为生命树的蕴含根</li>
</ul>
</li>
<li>
<p><strong>基线模型</strong>：</p>
<ul>
<li>CLIP, OpenCLIP, BioTroveCLIP, BioCLIP, TaxaBind, Radial Embeddings, MERU, ATMG</li>
<li>所有模型基于ViT-B/16架构</li>
</ul>
</li>
<li>
<p><strong>评估数据集</strong>：</p>
<ul>
<li>iNaturalist-2021：包含10,000种独特的动物、植物和真菌，测试集有100,000张图像</li>
<li>BioCLIP-Rare：IUCN红色名录中400种稀有动物，每种有30张评估图像</li>
</ul>
</li>
</ol>
<h2 id="实验验证与结果-1">实验验证与结果</h2>
<h3 id="分类标签的排序">分类标签的排序</h3>
<p>研究评估了不同模型在生命树中对分类标签进行排序的能力：</p>
<ol>
<li>
<p><strong>使用Kendall’s Tau(τd)评估排序准确性</strong>：</p>
<ul>
<li>RCME模型达到0.993，远高于基线模型（例如CLIP为0.737，BioCLIP仅为0.012）</li>
<li>表明RCME能有效对不同分类级别的标签进行正确排序，使物种级别嵌入投射到离根最远处，而界级别嵌入则更靠近根</li>
</ul>
</li>
<li>
<p><strong>层次化图像-文本检索指标</strong>：</p>
<ul>
<li>RCME在精确度(0.458)、召回率(0.572)和F1分数(0.508)上均优于基线模型</li>
<li>相比最好的基线模型，绝对精确度增益至少+0.102，召回率增益至少+0.376</li>
</ul>
</li>
</ol>
<h3 id="零样本分类">零样本分类</h3>
<p>在不同分类层级上进行独立的图像分类评估：</p>
<ol>
<li>
<p><strong>iNaturalist-2021数据集结果</strong>：</p>
<ul>
<li>RCME在所有分类层级上表现优异，平均准确率为65.09%，比最佳基线高5.17%</li>
<li>在界(Kingdom)级别达到88.18%，种(Species)级别达到73.52%</li>
<li>一些模型在纲(Class)、科(Family)和目(Order)级别表现较差，这可能是由于植物分类的挑战</li>
</ul>
</li>
<li>
<p><strong>BioCLIP-Rare数据集结果</strong>：</p>
<ul>
<li>RCME平均准确率为62.64%，比最佳基线高2.03%</li>
<li>在门(Phylum)级别达到79.60%，种级别达到41.62%</li>
<li>这个数据集只包含动物，因此在中间分类层级没有显示性能下降</li>
</ul>
</li>
</ol>
<h3 id="图像到图像检索">图像到图像检索</h3>
<p>评估模型在每个分类层级上的图像到图像检索能力：</p>
<ol>
<li>
<p><strong>召回率(R@1)结果</strong>：</p>
<ul>
<li>RCME平均召回率为86.88%，比最佳基线高3.33%</li>
<li>在界级别达到99.65%，种级别达到61.27%</li>
<li>传统的CLIP和OpenCLIP在属(Genus)和种级别表现较差，表明它们难以提取精细的视觉特征</li>
</ul>
</li>
<li>
<p><strong>径向嵌入的局限性</strong>：</p>
<ul>
<li>径向嵌入方法的性能仅限于所使用的冻结图像编码器，因为它不微调图像编码器</li>
<li>RCME通过同时微调视觉和文本编码器克服了这一限制</li>
</ul>
</li>
</ol>
<h3 id="umap可视化">UMAP可视化</h3>
<p>通过二维UMAP展示不同模型的文本嵌入：</p>
<ol>
<li>
<p><strong>嵌入空间组织</strong>：</p>
<ul>
<li>RCME成功保留了基于与蕴含根距离的分类标签偏序</li>
<li>物种级别的嵌入投影到离蕴含根最远处</li>
<li>BioCLIP和Radial Embeddings无法有效执行传递性约束</li>
</ul>
</li>
<li>
<p><strong>嵌入空间特性</strong>：</p>
<ul>
<li>同级的"兄弟"节点共享相似的嵌入</li>
<li>嵌入按从粗到细的方式排列（从界到种）</li>
</ul>
</li>
</ol>
<h3 id="消融实验">消融实验</h3>
<ol>
<li>
<p><strong>损失组件分析</strong>：</p>
<ul>
<li>添加全局蕴含目标函数显著提升了性能，从39.13%提高到43.65%</li>
<li>使用跨模态对齐损失优于先验保存损失，性能提升3.36%</li>
<li>全局+局部+跨模态组合实现了最佳性能(65.09%)</li>
</ul>
</li>
<li>
<p><strong>难负样本挖掘的影响</strong>：</p>
<ul>
<li>使用难负样本挖掘比随机采样提高了4.61%(iNaturalist)和5.62%(BioCLIP-Rare)的性能</li>
</ul>
</li>
<li>
<p><strong>在HierarCaps数据集上的泛化性</strong>：</p>
<ul>
<li>在HierarCaps数据集上的实验证明了RCME框架的通用适用性</li>
<li>在ViT-B/16和ViT-L/14上都优于基线方法</li>
<li>表明RCME可成功应用于不同领域的应用</li>
</ul>
</li>
</ol>
<h2 id="未来研究方向与挑战-1">未来研究方向与挑战</h2>
<h3 id="值得探索的问题-1">值得探索的问题</h3>
<ol>
<li>
<p><strong>改进植物分类表现</strong>：</p>
<ul>
<li>研究表明，模型在植物的纲、科和目级别表现较差，这可能是由于形态多样性、杂交、遗传复杂性等因素导致的植物分类复杂性</li>
<li>可探索更专门的特征提取或分层表示方法来改善植物分类性能</li>
</ul>
</li>
<li>
<p><strong>适应不同粒度的分类任务</strong>：</p>
<ul>
<li>开发能够根据用户需求或可用数据自适应选择分类层级的系统</li>
<li>解决某些分类层级（如纲、科、目）性能不一致的问题</li>
</ul>
</li>
<li>
<p><strong>扩展到其他模态</strong>：</p>
<ul>
<li>将RCME框架扩展到包含音频、DNA序列或卫星图像等其他生态相关模态</li>
<li>构建多模态层次化表示系统</li>
</ul>
</li>
<li>
<p><strong>应用于物种演化理解</strong>：</p>
<ul>
<li>利用学习到的层次化表示来理解和理解物种演化</li>
<li>识别生命树内的特殊异常现象，并制定策略改进分类系统</li>
</ul>
</li>
</ol>
<h3 id="技术机会-1">技术机会</h3>
<ol>
<li>
<p><strong>细粒度检索增强生成</strong>：</p>
<ul>
<li>将RCME框架与大型语言模型集成，实现细粒度检索增强生成</li>
<li>创建能够根据分类层级生成准确描述的系统</li>
</ul>
</li>
<li>
<p><strong>自适应层次学习</strong>：</p>
<ul>
<li>开发能根据领域特性自动调整层次结构的方法</li>
<li>处理分类学变化和新发现的动态更新机制</li>
</ul>
</li>
<li>
<p><strong>生物多样性监测系统</strong>：</p>
<ul>
<li>将RCME集成到实时生物多样性监测系统中</li>
<li>结合卫星图像、相机陷阱数据和公民科学观察建立综合监测平台</li>
</ul>
</li>
</ol>
<h2 id="不足与局限性-1">不足与局限性</h2>
<h3 id="论文存在的局限-1">论文存在的局限</h3>
<ol>
<li>
<p><strong>计算复杂性</strong>：</p>
<ul>
<li>文章未详细讨论RCME框架的计算复杂性</li>
<li>层次化表示可能增加训练和推理的计算成本，特别是对于大规模数据集</li>
</ul>
</li>
<li>
<p><strong>对稀有物种的表现</strong>：</p>
<ul>
<li>虽然BioCLIP-Rare数据集包含稀有物种，但文章未专门分析模型对极度濒危或样本极少物种的表现</li>
<li>这对保护生物学有重要意义</li>
</ul>
</li>
<li>
<p><strong>模型可解释性</strong>：</p>
<ul>
<li>缺乏关于为什么某些分类级别表现不佳的深入分析</li>
<li>没有探讨模型如何处理分类学变化或分类争议</li>
</ul>
</li>
</ol>
<h3 id="需要进一步验证的问题-1">需要进一步验证的问题</h3>
<ol>
<li>
<p><strong>长期泛化能力</strong>：</p>
<ul>
<li>随着分类系统的演变和新物种的发现，模型的泛化能力需要长期验证</li>
<li>如何适应分类系统的变化值得进一步研究</li>
</ul>
</li>
<li>
<p><strong>跨域迁移能力</strong>：</p>
<ul>
<li>虽然在HierarCaps数据集上进行了测试，但需要更多领域验证RCME的通用性</li>
<li>例如医学分类、地质学分类等其他层次化领域的应用</li>
</ul>
</li>
<li>
<p><strong>与其他超几何方法的比较</strong>：</p>
<ul>
<li>与超双曲空间或其他非欧几何空间方法的系统比较</li>
<li>理解不同几何空间对层次化表示的优劣</li>
</ul>
</li>
</ol>
<h2 id="实用创新与应用启示-1">实用创新与应用启示</h2>
<h3 id="值得学习的创新点-1">值得学习的创新点</h3>
<ol>
<li>
<p><strong>传递性强制蕴含的显式建模</strong>：</p>
<ul>
<li>RCME框架通过全局蕴含学习目标显式建模传递性，这是其核心创新</li>
<li>摆脱了对预定义锥结构的依赖，同时保留了层次化表示的关键性质</li>
</ul>
</li>
<li>
<p><strong>跨模态和内模态表示的同步改进</strong>：</p>
<ul>
<li>通过联合优化视觉和文本编码器，实现了跨模态和内模态表示的同步增强</li>
<li>这与仅优化文本编码器的传统方法形成对比</li>
</ul>
</li>
<li>
<p><strong>难负样本挖掘策略</strong>：</p>
<ul>
<li>提出的难负样本挖掘方法针对层次化分类任务特别设计</li>
<li>通过匹配所有先前层级来创建更具挑战性的负样本</li>
</ul>
</li>
<li>
<p><strong>多层级评估框架</strong>：</p>
<ul>
<li>建立了一个全面的评估框架，在不同分类层级上单独测试模型性能</li>
<li>这种方法可以应用于其他领域的层次化分类任务</li>
</ul>
</li>
</ol>
<h3 id="实用启示-1">实用启示</h3>
<ol>
<li>
<p><strong>生物多样性研究与保护</strong>：</p>
<ul>
<li>层次化表示能够帮助生物学家在任何分类层级进行推理，即使物种标签不完全</li>
<li>可用于为具有适当专业知识的生物学家分组和路由标本</li>
<li>支持对稀有或未描述物种的识别和研究</li>
</ul>
</li>
<li>
<p><strong>分类系统改进</strong>：</p>
<ul>
<li>通过识别分类异常（如植物分类中的低性能区域），可以帮助改进分类系统</li>
<li>提供基于数据驱动的方法来评估和完善传统分类学</li>
</ul>
</li>
<li>
<p><strong>公民科学与教育应用</strong>：</p>
<ul>
<li>为不同专业水平的用户提供在适当层级进行物种识别的能力</li>
<li>增强公民科学平台的功能，提高公众参与生物多样性监测的质量</li>
</ul>
</li>
<li>
<p><strong>计算机视觉模型设计启示</strong>：</p>
<ul>
<li>层次化表示学习对于具有自然层次结构的其他领域（如医学诊断、文档分类）具有广泛应用潜力</li>
<li>显示了同时优化全局结构和局部细节的重要性</li>
</ul>
</li>
</ol>
<h3 id="需要补充的背景知识-1">需要补充的背景知识</h3>
<ol>
<li>
<p><strong>分类学基础</strong>：</p>
<ul>
<li>生命树(Tree of Life)的结构和分类系统（界、门、纲、目、科、属、种）</li>
<li>当前分类系统面临的挑战和争议</li>
</ul>
</li>
<li>
<p><strong>蕴含学习基础</strong>：</p>
<ul>
<li>理解蕴含关系的数学表达和几何解释</li>
<li>传递性在偏序关系中的重要性</li>
</ul>
</li>
<li>
<p><strong>超几何嵌入技术</strong>：</p>
<ul>
<li>超几何空间的基本性质和与欧几何空间的区别</li>
<li>超几何嵌入在表示层次数据方面的优势</li>
</ul>
</li>
<li>
<p><strong>视觉-语言模型架构</strong>：</p>
<ul>
<li>CLIP等视觉-语言模型的工作原理</li>
<li>对比学习在多模态表示中的应用</li>
</ul>
</li>
</ol>
<p>总结来说，RCME框架通过显式建模传递性强制蕴含，成功地解决了现有蕴含学习方法的局限性，为生命树等自然层次结构的表示提供了有效解决方案。这一研究不仅在技术上具有创新性，而且在生物多样性监测、分类学改进和物种保护等实际应用中具有重要价值。</p>
<h1 id="phyclip-ℓ1-积超几何因子统一视觉-语言表示学习中的层次结构与组合性">PHyCLIP: ℓ1-积超几何因子统一视觉-语言表示学习中的层次结构与组合性</h1>
<h2 id="研究目标与实际意义-2">研究目标与实际意义</h2>
<h3 id="研究目标-2">研究目标</h3>
<ul>
<li>提出PHyCLIP框架，使用超几何因子的ℓ1-积度量空间来同时表示两种不同类型的语义结构：概念家族内部的层次结构（如dog⪯mammal⪯animal）和跨不同概念家族的组合性（如"a dog in a car"⪯dog, car）</li>
<li>解决现有视觉-语言模型在同时表示层次结构和组合性时面临的困境</li>
<li>创建一个能够有效捕获层次与组合语义的视觉-语言表示框架</li>
</ul>
<h3 id="实际问题及意义-1">实际问题及意义</h3>
<ul>
<li>现有视觉-语言模型将实例语义压缩到单一点，难以同时忠实编码两种语义结构（层次性和组合性）</li>
<li>视觉和语言概念形成树状的分类层次结构，而欧几里得几何难以有效表示这种结构，超几何空间则更为适合</li>
<li>然而，超几何空间虽能捕获层次关系，但缺乏表示组合性的标准操作</li>
<li>组合性关系通常使用布尔代数或加性操作表示，但这些方法难以高效编码语义层次结构</li>
<li>PHyCLIP通过将这两种表示方法结合，为视觉-语言表示学习提供了更有效的解决方案</li>
</ul>
<h2 id="方法创新与技术细节-2">方法创新与技术细节</h2>
<h3 id="理论基础">理论基础</h3>
<p>论文首先介绍了两个关键的理论对应关系：</p>
<ol>
<li>
<p><strong>度量树与超几何空间的对应</strong>：</p>
<ul>
<li>度量树可以低失真地嵌入到超几何空间中（Sarkar, 2011定理）</li>
<li>超几何因子可以有效地嵌入概念家族内的分类层次结构</li>
</ul>
</li>
<li>
<p><strong>布尔代数与ℓ1空间的对应</strong>：</p>
<ul>
<li>具有汉明距离的有限布尔代数可以等距嵌入到ℓ1空间</li>
<li>ℓ1-积度量自然支持类似布尔运算的跨概念家族组合</li>
</ul>
</li>
</ol>
<h3 id="phyclip框架设计">PHyCLIP框架设计</h3>
<p>PHyCLIP的核心是使用超几何因子的ℓ1-积度量空间(Hd)k，具体设计如下：</p>
<ol>
<li>
<p><strong>超几何因子空间</strong>：</p>
<ul>
<li>每个图像和文本被编码为k个d维超几何空间Hd中的点的元组X = (x(1),…,x(k))</li>
<li>每个超几何因子Hdi表示一个概念家族的分类层次结构（如动物、交通工具等）</li>
<li>使用Lorentz模型表示超几何空间，具有可学习的曲率-αi</li>
</ul>
</li>
<li>
<p><strong>ℓ1-积度量</strong>：</p>
<ul>
<li>定义ℓ1-积度量：d(Hd)k(X, Y) = ∑ki=1 dHdi(x(i), y(i))</li>
<li>该度量通过各因子超几何距离的总和来衡量嵌入间的距离</li>
<li>平均版本：davg(X, Y) = (1/k)·d(Hd)k(X, Y)</li>
</ul>
</li>
<li>
<p><strong>数学表示</strong>：</p>
<ul>
<li>对于图像编码器和文本编码器，通过映射函数将其输出v切分为k个d维段落v(i)</li>
<li>每段v(i)通过指数映射被提升到对应的超几何因子Hdi，形成x(i)</li>
<li>嵌入X = (x(1),…,x(k)) ∈ (Hd)k表示输入实例</li>
</ul>
</li>
<li>
<p><strong>蕴含关系表示</strong>：</p>
<ul>
<li>使用超几何蕴含锥来捕获蕴含关系（Ganea et al., 2018a）</li>
<li>对于每个超几何因子中的点y(i)，定义一个测地线锥区域C(y(i))，其半张角为ω(y(i))</li>
<li>x(i) ∈ C(y(i))当且仅当外角φ(x(i), y(i)) &lt; ω(y(i))</li>
</ul>
</li>
</ol>
<h3 id="损失函数设计">损失函数设计</h3>
<p>PHyCLIP使用两种主要损失函数：</p>
<ol>
<li>
<p><strong>对比损失（Lconv）</strong>：</p>
<pre><code>Lcont({Xb},{Yb}) = -∑b∈B log[exp(-davg(Xb,Yb)/τ) / ∑a∈B exp(-davg(Xb,Ya)/τ)]
</code></pre>
<ul>
<li>使用InfoNCE损失，拉近正样本对嵌入，推远负样本对嵌入</li>
<li>τ是可学习的温度参数</li>
<li>对四种已知对（图像-文本、文本-图像、图像框-文本框、文本框-图像框）取平均</li>
</ul>
</li>
<li>
<p><strong>蕴含损失（Lent）</strong>：</p>
<pre><code>Lent,i(X, Y) = max(0, φ(x(i), y(i)) - ηω(y(i)))
Lent(X, Y) = (1/k)∑ki=1 Lent,i(X, Y)
</code></pre>
<ul>
<li>惩罚蕴含关系x(i) ∈ C(y(i))的违反情况</li>
<li>超参数η控制边际</li>
<li>对所有已知蕴含对求和</li>
</ul>
</li>
<li>
<p><strong>总体目标函数</strong>：</p>
<pre><code>Loverall = Lcont + γLent
</code></pre>
<ul>
<li>γ是两种损失的权重超参数</li>
</ul>
</li>
</ol>
<h2 id="实验验证与结果-2">实验验证与结果</h2>
<h3 id="实验设置-2">实验设置</h3>
<ol>
<li>
<p><strong>数据集</strong>：</p>
<ul>
<li>使用自动注释的Grounded Image-Text Pairs (GRIT)数据集训练所有模型</li>
<li>包含1400万图像-文本对，带有2660万边界框注释</li>
</ul>
</li>
<li>
<p><strong>基线模型</strong>：</p>
<ul>
<li>CLIP：在欧几里得空间中训练的对比视觉-语言模型</li>
<li>MERU：将CLIP扩展到超几何空间，使用超几何蕴含锥</li>
<li>HyCoCLIP：在MERU基础上利用框注释更好地捕获模态内层次结构</li>
</ul>
</li>
<li>
<p><strong>实现细节</strong>：</p>
<ul>
<li>PHyCLIP使用k=64个因子，每个因子维度d=8，总维度512</li>
<li>使用Vision Transformer作为图像编码器</li>
</ul>
</li>
</ol>
<h3 id="零样本图像分类结果">零样本图像分类结果</h3>
<p>在16个数据集上进行评估，分为通用、细粒度和专业数据集：</p>
<ol>
<li>
<p><strong>通用数据集</strong>：</p>
<ul>
<li>PHyCLIP在ImageNet上达到44.43%，CIFAR-10达到89.30%，CIFAR-100达到59.83%</li>
<li>比最接近的竞争对手HyCoCLIP分别高出1.5%、0.79%和2.15%</li>
</ul>
</li>
<li>
<p><strong>细粒度数据集</strong>：</p>
<ul>
<li>Food-101上达到56.81%，提升了5.1%</li>
<li>Oxford-IIIT Pets上达到54.64%，提升了4%</li>
<li>在某些极具挑战性的数据集（如FGVC-Aircraft）表现一般</li>
</ul>
</li>
<li>
<p><strong>专业数据集</strong>：</p>
<ul>
<li>RESISC45上达到50.13%，提升了4%</li>
<li>EuroSAT等数据集表现未达最佳，可能因为与训练数据分布差异大</li>
</ul>
</li>
</ol>
<h3 id="零样本检索结果">零样本检索结果</h3>
<p>在COCO和Flickr30K上评估跨模态对齐：</p>
<ol>
<li>
<p><strong>文本到图像检索</strong>：</p>
<ul>
<li>COCO R@5：58.00%，R@10：68.74%</li>
<li>Flickr30K R@5：83.40%，R@10：89.92%</li>
<li>在所有指标上均优于其他基线模型</li>
</ul>
</li>
<li>
<p><strong>图像到文本检索</strong>：</p>
<ul>
<li>与CLIP表现接近，但整体仍具竞争力</li>
<li>COCO R@5：70.20%，R@10：80.44%</li>
</ul>
</li>
</ol>
<h3 id="层次分类结果">层次分类结果</h3>
<p>在ImageNet上基于WordNet层次结构进行评估：</p>
<ol>
<li>
<p><strong>性能指标</strong>：</p>
<ul>
<li>树诱导误差(TIE)：3.285（越低越好）</li>
<li>最低共同祖先误差(LCA)：2.088（越低越好）</li>
<li>Jaccard相似度(J)：0.8065（越高越好）</li>
<li>层次精确度(PH)：0.8684（越高越好）</li>
<li>层次召回率(RH)：0.8682（越高越好）</li>
</ul>
</li>
<li>
<p><strong>关键发现</strong>：</p>
<ul>
<li>PHyCLIP在所有指标上均优于基线模型</li>
<li>错误分类的情况更倾向于在分类层次结构中接近真实类别</li>
<li>通过ℓ1-积度量处理跨概念家族组合性，每个超几何因子能够更专注于更纯粹的概念家族分类层次结构</li>
</ul>
</li>
</ol>
<h3 id="组合理解结果">组合理解结果</h3>
<p>使用VL-CheckList-Object和SugarCrepe评估组合性理解：</p>
<ol>
<li>
<p><strong>VL-CheckList-Object</strong>：</p>
<ul>
<li>根据替换对象的位置和大小分别评估</li>
<li>PHyCLIP在所有位置和大小类别上均表现最佳</li>
<li>在中心位置达到73.0%，比最接近竞争者高出7.1%</li>
<li>在大型对象上达到76.4%，比最接近竞争者高出8.8%</li>
</ul>
</li>
<li>
<p><strong>SugarCrepe</strong>：</p>
<ul>
<li>PHyCLIP在七个子集中四个表现最佳，两个表现第二</li>
<li>平均分数比第二名高出1%以上</li>
<li>在属性子集上表现稳健，表明设计有效分离了概念家族内部分类与跨概念家族组合</li>
</ul>
</li>
</ol>
<h3 id="消融实验-1">消融实验</h3>
<ol>
<li>
<p><strong>因子数量分析</strong>：</p>
<ul>
<li>固定总嵌入维度，调整因子数量k和每个因子维度d</li>
<li>k=1（相当于HyCoCLIP）在多数指标上表现最差</li>
<li>k=64或k=128时性能最佳</li>
<li>过细的因子划分可能损害内部分类层次结构表示能力</li>
</ul>
</li>
<li>
<p><strong>度量选择分析</strong>：</p>
<ul>
<li>将ℓ1-积度量替换为黎曼（ℓ2）积度量导致大多数任务性能下降</li>
<li>支持ℓ1-积度量更有效地聚合跨概念家族组合</li>
</ul>
</li>
</ol>
<h3 id="超几何因子可视化">超几何因子可视化</h3>
<p>研究提供了嵌入空间的丰富可视化：</p>
<ol>
<li>
<p><strong>范数分布</strong>：</p>
<ul>
<li>PHyCLIP和HyCoCLIP中，图像范数一致大于文本范数</li>
<li>在单个超几何因子中，图像和文本分布大量重叠，表明因子被选择性使用</li>
<li>这使PHyCLIP能利用更广泛的嵌入空间部分并在对比学习下实现有意义的距离和分类结构</li>
</ul>
</li>
<li>
<p><strong>通过ℓ1-积度量的组合</strong>：</p>
<ul>
<li>单概念提示（如"dog"和"car"）在不同因子中显示最大范数</li>
<li>组合概念（如"dog and car"）同时激活相应因子</li>
<li>这种模式与布尔代数行为一致，其中多个概念通过概念子集的并集来指定</li>
</ul>
</li>
<li>
<p><strong>因子语义专业化</strong>：</p>
<ul>
<li>某些因子自然对应特定概念家族（如哺乳动物、交通工具等）</li>
<li>使用HoroPCA将嵌入投影到2D圆盘，显示相关术语在对应因子中形成层次结构</li>
<li>这种专业化自动出现，未使用显式监督</li>
</ul>
</li>
</ol>
<h2 id="未来研究方向与挑战-2">未来研究方向与挑战</h2>
<h3 id="值得探索的问题-2">值得探索的问题</h3>
<ol>
<li>
<p><strong>关系结构建模</strong>：</p>
<ul>
<li>当前模型主要专注于对象组合，关系结构尚未充分探索</li>
<li>将关系的代数结构融入模型是未来工作的一个有前景的方向</li>
</ul>
</li>
<li>
<p><strong>动态调整因子数量</strong>：</p>
<ul>
<li>研究数据依赖性的因子数量分配策略</li>
<li>探索不同概念家族可能需要不同粒度的表示</li>
</ul>
</li>
<li>
<p><strong>模型理论能力边界</strong>：</p>
<ul>
<li>进一步研究ℓ1-积超几何因子空间表示复杂语义结构的理论能力边界</li>
<li>理解在哪些语义结构情况下该表示可能面临挑战</li>
</ul>
</li>
<li>
<p><strong>其他产品度量的应用</strong>：</p>
<ul>
<li>探索ℓp（p≠1,2）积度量的应用可能性</li>
<li>研究混合曲率空间以表示更复杂的关系结构</li>
</ul>
</li>
</ol>
<h3 id="技术机会-2">技术机会</h3>
<ol>
<li>
<p><strong>扩展到更多领域</strong>：</p>
<ul>
<li>将PHyCLIP框架扩展到医学诊断、材料科学等其他具有层次和组合结构的领域</li>
<li>探索在跨语言和多语言设置中的应用</li>
</ul>
</li>
<li>
<p><strong>融合生成模型</strong>：</p>
<ul>
<li>将PHyCLIP的表示能力与生成模型结合</li>
<li>开发能够理解并生成具有复杂组合和层次结构的内容的模型</li>
</ul>
</li>
<li>
<p><strong>嵌入空间的可解释性</strong>：</p>
<ul>
<li>进一步开发超几何因子空间的可视化和解释工具</li>
<li>探索将学习到的表示用于知识提取和概念发现</li>
</ul>
</li>
<li>
<p><strong>降低计算复杂性</strong>：</p>
<ul>
<li>研究更高效的实现方法，以减少超几何运算的计算开销</li>
<li>开发适用于资源受限环境的轻量级版本</li>
</ul>
</li>
</ol>
<h2 id="不足与局限性-2">不足与局限性</h2>
<h3 id="论文存在的局限-2">论文存在的局限</h3>
<ol>
<li>
<p><strong>计算复杂性考量</strong>：</p>
<ul>
<li>论文未详细讨论PHyCLIP与基线方法相比的计算复杂性差异</li>
<li>虽然总维度相同，但超几何运算可能增加计算开销</li>
</ul>
</li>
<li>
<p><strong>因子专业化的稳定性</strong>：</p>
<ul>
<li>虽然论文提到因子专业化自然出现，但未探讨这种专业化的稳定性和一致性</li>
<li>不同初始化可能导致不同的因子分配，影响可解释性</li>
</ul>
</li>
<li>
<p><strong>对关系结构的处理有限</strong>：</p>
<ul>
<li>在关系替换和对象交换任务上表现相对较弱</li>
<li>表明当前设计对表示对象间关系的能力有限</li>
</ul>
</li>
<li>
<p><strong>缺乏超参数敏感性分析</strong>：</p>
<ul>
<li>论文未提供关于关键超参数（如γ、η等）对性能影响的详细分析</li>
<li>这些参数的选择对模型表现可能有显著影响</li>
</ul>
</li>
</ol>
<h3 id="需要进一步验证的问题-2">需要进一步验证的问题</h3>
<ol>
<li>
<p><strong>零样本迁移能力</strong>：</p>
<ul>
<li>模型在未见过的数据分布上的表现需要更多验证</li>
<li>特别是当概念组合方式与训练数据显著不同时</li>
</ul>
</li>
<li>
<p><strong>长尾分布下的表现</strong>：</p>
<ul>
<li>未专门评估模型在处理罕见概念或罕见组合时的表现</li>
<li>这对实际应用场景尤为重要</li>
</ul>
</li>
<li>
<p><strong>理论框架的普适性</strong>：</p>
<ul>
<li>需要更多实验验证ℓ1-积超几何因子空间是否适用于所有类型的语义结构</li>
<li>可能存在某些特殊的语义关系难以用当前框架表示</li>
</ul>
</li>
<li>
<p><strong>与其他表示方法的比较</strong>：</p>
<ul>
<li>缺乏与其他表示方法（如区域嵌入、盒嵌入等）的系统比较</li>
<li>这些比较有助于理解各种表示方法的优缺点</li>
</ul>
</li>
</ol>
<h2 id="实用创新与应用启示-2">实用创新与应用启示</h2>
<h3 id="值得学习的创新点-2">值得学习的创新点</h3>
<ol>
<li>
<p><strong>几何空间设计的理论动机</strong>：</p>
<ul>
<li>基于树状结构与超几何空间的理论对应性选择表示空间</li>
<li>基于布尔代数与ℓ1空间的理论对应性设计组合机制</li>
<li>这种基于理论的设计思路值得借鉴</li>
</ul>
</li>
<li>
<p><strong>使用ℓ1-积度量而非欧几里得积度量</strong>：</p>
<ul>
<li>ℓ1-积度量更适合表示组合关系，符合概念组合的直觉</li>
<li>避免了单一空间难以同时表示层次和组合的困境</li>
</ul>
</li>
<li>
<p><strong>因子的自动专业化</strong>：</p>
<ul>
<li>模型自动学习因子的专业化，无需显式监督</li>
<li>这种自组织特性使模型具有更好的可解释性</li>
</ul>
</li>
<li>
<p><strong>综合利用现有技术</strong>：</p>
<ul>
<li>巧妙结合超几何蕴含锥和ℓ1-积度量</li>
<li>在保持各自优势的同时规避了各自局限性</li>
</ul>
</li>
</ol>
<h3 id="实用启示-2">实用启示</h3>
<ol>
<li>
<p><strong>表示学习设计原则</strong>：</p>
<ul>
<li>表示空间的选择应与数据的内在几何结构相匹配</li>
<li>复杂语义结构可能需要复合几何空间</li>
</ul>
</li>
<li>
<p><strong>细粒度视觉识别应用</strong>：</p>
<ul>
<li>PHyCLIP在细粒度数据集（如Food-101、Pets等）上表现优异</li>
<li>可应用于需要识别细微差异的领域，如医疗诊断、生物多样性监测等</li>
</ul>
</li>
<li>
<p><strong>多模态检索系统优化</strong>：</p>
<ul>
<li>利用ℓ1-积度量可提升检索系统性能，特别是处理组合查询时</li>
<li>为跨模态检索系统提供更精确的相似度度量</li>
</ul>
</li>
<li>
<p><strong>知识图谱与概念层次集成</strong>：</p>
<ul>
<li>PHyCLIP的表示可与结构化知识源（如WordNet）自然集成</li>
<li>有助于构建能理解概念层次的智能系统</li>
</ul>
</li>
</ol>
<h3 id="需要补充的背景知识-2">需要补充的背景知识</h3>
<ol>
<li>
<p><strong>微分几何与黎曼流形</strong>：</p>
<ul>
<li>理解超几何空间的基本性质</li>
<li>熟悉Lorentz模型及其在表示学习中的应用</li>
</ul>
</li>
<li>
<p><strong>顺序嵌入理论</strong>：</p>
<ul>
<li>掌握顺序嵌入、盒嵌入等表示偏序关系的方法</li>
<li>理解它们与蕴含关系的联系</li>
</ul>
</li>
<li>
<p><strong>布尔代数基础</strong>：</p>
<ul>
<li>理解布尔代数的基本结构和操作</li>
<li>了解其与组合语义的关系</li>
</ul>
</li>
<li>
<p><strong>视觉-语言模型架构</strong>：</p>
<ul>
<li>熟悉CLIP等对比视觉-语言模型的基本原理</li>
<li>了解Vision Transformer和文本编码器的工作机制</li>
</ul>
</li>
</ol>
<p>PHyCLIP通过巧妙结合超几何空间的层次表示能力和ℓ1-积度量的组合表示能力，成功构建了一个能同时有效表示层次结构和组合性的视觉-语言模型。这种设计不仅在各种下游任务上取得了优异的性能，还提供了更具解释性的嵌入结构，为未来视觉-语言表示学习提供了新的研究方向。</p>

