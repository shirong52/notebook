---


---

<h2 id="任务清单">任务清单</h2>
<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked="true" disabled=""> 找代码爆掉原因</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked="true" disabled=""> 两道代码随想录</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked="true" disabled=""> 看cs336第一节</li>
</ul>
<h2 id="代码随想录">代码随想录</h2>
<h3 id="四数相加">1. 四数相加</h3>
<p><a href="https://www.programmercarl.com/0454.%E5%9B%9B%E6%95%B0%E7%9B%B8%E5%8A%A0II.html#%E7%AE%97%E6%B3%95%E5%85%AC%E5%BC%80%E8%AF%BE">代码随想录</a><br>
<a href="https://leetcode.cn/problems/4sum-ii/description/">454. 四数相加 II - 力扣（LeetCode）</a><br>
<a href="https://www.bilibili.com/video/BV1Md4y1Q7Yh/">学透哈希表，map使用有技巧！LeetCode：454.四数相加II_哔哩哔哩_bilibili</a></p>
<ul>
<li>暴力解法为遍历四个数组，时间复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>4</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>；这里两两遍历，先预处理前两个数组，然后再处理后两个数组，再在集合里去查，时间复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li>
<li>数组数值数量不一定，考虑set或map。由于不仅要统计是否出现过，还要统计出现过的次数，故用map。</li>
<li>map中，key对应a+b，value对应次数，需要查询的是0-(c+d)。原因在于0-(c+d)=a+b，符合题目规则了</li>
<li>注意：count不是++，应该是count+=value</li>
</ul>
<pre class=" language-c"><code class="prism  language-c"><span class="token comment">//伪代码</span>
<span class="token function">unordered_map</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span> map<span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span>A<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>b<span class="token punctuation">:</span>B<span class="token punctuation">)</span><span class="token punctuation">{</span>
		map<span class="token punctuation">[</span>a<span class="token operator">+</span>b<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>c<span class="token punctuation">:</span>C<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>d<span class="token punctuation">:</span>D<span class="token punctuation">)</span><span class="token punctuation">{</span>
		target <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">-</span><span class="token punctuation">(</span>c<span class="token operator">+</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">!=</span> map<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">{</span>
			count <span class="token operator">+</span><span class="token operator">=</span> map<span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="赎金信">2. 赎金信</h3>
<p><a href="https://www.programmercarl.com/0383.%E8%B5%8E%E9%87%91%E4%BF%A1.html#%E5%85%B6%E4%BB%96%E8%AF%AD%E8%A8%80%E7%89%88%E6%9C%AC">代码随想录</a><br>
<a href="https://leetcode.cn/problems/ransom-note/submissions/656737237/">383. 赎金信 - 力扣（LeetCode）</a></p>
<ul>
<li>和有效字母异位词类似</li>
</ul>
<h3 id="三数之和">3. 三数之和</h3>
<p><a href="https://www.programmercarl.com/0015.%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C.html#%E7%AE%97%E6%B3%95%E5%85%AC%E5%BC%80%E8%AF%BE">代码随想录</a><br>
<a href="https://leetcode.cn/problems/3sum/description/">15. 三数之和 - 力扣（LeetCode）</a><br>
<a href="https://www.bilibili.com/video/BV1GW4y127qo/?vd_source=96ef48634663967d0116e79abff26934">梦破碎的地方！| LeetCode：15.三数之和_哔哩哔哩_bilibili</a></p>
<ul>
<li>这里需要去重，涉及较多细节，不建议用哈希法</li>
<li>使用双指针法，首先要对数组进行排序（找元素值的三数之和，没有让返回下标，否则排序后下标就乱了，不应该排序）</li>
<li>a，b，c三个数都要去重，是关键</li>
</ul>
<pre class=" language-c"><code class="prism  language-c"><span class="token comment">//伪代码</span>
<span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token comment">//对a去重</span>
	left <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	right <span class="token operator">=</span> nums<span class="token punctuation">.</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>right <span class="token operator">&gt;</span> left<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> right<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> left<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token comment">//b和c的去重逻辑，这个去重一定要放在收获结果的下面，否则还未获得结果就已经不满足循环条件了</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>right <span class="token operator">&gt;</span> left <span class="token operator">&amp;&amp;</span> right<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>right<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> right<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>right <span class="token operator">&gt;</span> left <span class="token operator">&amp;&amp;</span> right<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>right<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> left <span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//去重注意</span>
nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//和后一个做对比，判断结果集里面是否重复，但实际可以存在{-1(i)，-1(left)，2(right)}的三个数</span>
nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//和前一个做对比，正常收集这组元素，left和right都不受影响</span>
</code></pre>
<h3 id="四数之和">4. 四数之和</h3>
<p><a href="https://www.programmercarl.com/0018.%E5%9B%9B%E6%95%B0%E4%B9%8B%E5%92%8C.html#%E7%AE%97%E6%B3%95%E5%85%AC%E5%BC%80%E8%AF%BE">代码随想录</a><br>
<a href="https://leetcode.cn/problems/4sum/description/">18. 四数之和 - 力扣（LeetCode）</a><br>
<a href="https://www.bilibili.com/video/BV1DS4y147US/?vd_source=96ef48634663967d0116e79abff26934">难在去重和剪枝！| LeetCode：18. 四数之和_哔哩哔哩_bilibili</a></p>
<ul>
<li>在三数之和的基础上加上一个循环，k，nums[k] + nums[i] + nums[left] + nums[right]</li>
<li>剪枝操作：考虑复数，两负数相加可能变得更小，不能用nums[k] &gt; target来剪枝</li>
</ul>
<pre class=" language-c"><code class="prism  language-c"><span class="token comment">//剪枝</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">&gt;</span>target <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span>  <span class="token operator">&amp;&amp;</span> target <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token comment">//去重</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//剪枝</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> target <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&gt;</span> k <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="实验过程">实验过程</h2>
<ul>
<li>lorentz模型与poincare模型蕴含损失的差异：<a href="https://arxiv.org/abs/1902.00913">[1902.00913] Inferring Concept Hierarchies from Text Corpora via Hyperbolic Embeddings</a></li>
<li>运行方式：</li>
</ul>
<blockquote>
<p>nohup bash /root/meru/train_patches_shapes3d.sh 1 true</p>
</blockquote>
<ul>
<li>trae所给解决方案：</li>
</ul>
<blockquote>
<p>1.增加数值稳定性 :</p>
<ul>
<li>在所有涉及除法、开方、三角函数的操作中增加更严格的边界检查</li>
<li>增加eps值，例如从1e-8增加到1e-6或更大</li>
<li>在forward方法中添加对中间结果的检查，及时捕获NaN</li>
</ul>
<p>2.调整超参数 :</p>
<ul>
<li>降低学习率，例如从5e-4降低到1e-4</li>
<li>限制曲率参数的变化范围，可以设置更严格的min/max值</li>
<li>减小批量大小，例如从128减小到64或32</li>
</ul>
<p>3.梯度处理 :</p>
<ul>
<li>降低梯度裁剪的阈值，例如从1.0降低到0.5或0.1</li>
<li>在每个迭代中检查梯度是否包含NaN，如果有则跳过该批次</li>
</ul>
<p>4.模型结构调整 :</p>
<ul>
<li>减小patch_entail_weight的值，从0.1降低到0.05或更小</li>
<li>考虑在初始阶段不使用entailment loss，等模型稳定后再引入</li>
</ul>
</blockquote>
<h3 id="所做更改">所做更改</h3>
<ul>
<li>把batch_size由128缩小为64，50000个iteration看是否会出现nan</li>
<li>有点呆了…这次过后感觉就训480000/batch * n个epoch就行，batch为128的话15000个iteration有4个epoch，设为15000就能少跑点了…</li>
</ul>
<h2 id="cs336">CS336</h2>
<p><a href="https://www.youtube.com/watch?v=SQ3fZ1sAqXI&amp;list=PLoROMvodv4rOY23Y0BoGoBGgQ1zmU_MT_&amp;index=1">Stanford CS336 Language Modeling from Scratch | Spring 2025 | Lecture 1: Overview and Tokenization</a></p>
<h2 id="八股文链接">八股文链接</h2>
<p><a href="https://github.com/wdndev/llm_interview_note?tab=readme-ov-file">wdndev/llm_interview_note: 主要记录大语言大模型（LLMs） 算法（应用）工程师相关的知识及面试题</a><br>
<a href="https://wdndev.github.io/llm_interview_note/#/">首页</a></p>

