---


---

<h1 id="双曲层次聚类在视觉表示学习中的应用">双曲层次聚类在视觉表示学习中的应用</h1>
<h2 id="论文深入解读">论文深入解读</h2>
<p>本论文提出了一种名为<strong>HCFormer</strong>的新型视觉骨干网络，通过重新审视机器学习中最经典的方法之一——聚类算法，来改进视觉表示学习。论文的核心在于设计了一种名为<strong>ClusterMixer</strong>的透明且可解释的token混合器，它基于聚类范式显式地构建token之间的信息交互。</p>
<p>在视觉骨干网络中，有效的token混合是至关重要的组件，用于促进图像块之间的信息交换。主流的token混合方式，如卷积、自注意力、MLP或它们的混合体，主要关注准确性和计算成本之间的权衡，但它们大多是"黑盒"式的，缺乏可解释性。相比之下，ClusterMixer通过层次聚类机制显式地构建token混合过程，提供了透明度和可解释性。</p>
<p>为了更好地建模视觉数据中固有的树状关系，作者将聚类过程在双曲空间中进行。双曲空间因其负曲率特性，能够以低失真率嵌入层次结构，非常适合表示视觉数据中的抽象和复杂语义关系。基于ClusterMixer，作者构建了完整的HCFormer骨干架构，并设计了一系列精心策略以确保其在各种任务上的稳健性能。</p>
<p>HCFormer的设计包含两个关键创新：</p>
<ol>
<li><strong>层次聚类策略</strong>：将输入块分为若干不重叠的窗口，限制聚类操作在局部窗口内进行，以降低计算复杂度。为了捕获全局上下文信息，进一步在这些窗口上应用混合操作。</li>
<li><strong>双曲层次聚类</strong>：在双曲空间中执行聚类，更好地捕捉语义的层次关系。具体实现上，在细粒度的块级别使用欧氏空间计算相似性，在抽象的窗口级别使用双曲空间计算相似性，结合两种几何空间的优势。</li>
</ol>
<p>实验结果表明，HCFormer在多种视觉任务上表现出色：</p>
<ul>
<li>在ImageNet-1K图像分类上，超过ResNet-50 2.6%和Swin-Tiny 1.1%的top-1准确率</li>
<li>在ADE20K语义分割上，比现有聚类基础的方法提高0.7%~2.5% mIoU</li>
<li>在COCO目标检测和实例分割上也展示了竞争力的性能</li>
</ul>
<p>值得注意的是，这些性能提升是建立在可解释性基础上的，这使得HCFormer在追求准确性的同时不牺牲模型的透明度，为可解释的视觉骨干网络开辟了一条新的道路。</p>
<h2 id="研究目标与实际问题">研究目标与实际问题</h2>
<h3 id="论文的研究目标是什么？想要解决什么实际问题？这个问题对于产业发展有什么重要意义？">1. 论文的研究目标是什么？想要解决什么实际问题？这个问题对于产业发展有什么重要意义？</h3>
<p><strong>研究目标</strong>：</p>
<ul>
<li>重新审视聚类算法在视觉表示学习中的应用，设计一种基于聚类的可解释token混合器</li>
<li>解决现有聚类方法在视觉骨干网络中的效率和性能问题，特别是通过双曲空间更好地建模层次关系</li>
<li>构建一个透明且高效的视觉骨干网络，在保持可解释性的同时实现具有竞争力的性能</li>
</ul>
<p><strong>想要解决的实际问题</strong>：</p>
<ul>
<li>现有视觉骨干网络（如ViT、ConvNet）缺乏可解释性，它们的编码过程不透明</li>
<li>现有的聚类方法在建模层次结构时受限于欧氏空间的"平坦"特性，导致语义距离失真</li>
<li>聚类算法面临计算效率问题，尤其在处理大量token和聚类中心时计算复杂度高</li>
</ul>
<p><strong>对产业发展的重要意义</strong>：</p>
<ul>
<li>为AI可解释性提供新的方向，满足对透明AI系统日益增长的需求，特别是在医疗、自动驾驶等高风险领域</li>
<li>为部署需要理解推理过程的下游应用提供基础，如蛋白质设计或化学合成等科学应用</li>
<li>提供了一种计算效率和模型性能之间良好平衡的方法，有潜力在资源受限的边缘设备上应用</li>
</ul>
<h2 id="方法与模型">方法与模型</h2>
<h3 id="论文提出了哪些新的思路，方法或模型？跟之前的方法相比有什么特点和优势？">2. 论文提出了哪些新的思路，方法或模型？跟之前的方法相比有什么特点和优势？</h3>
<h4 id="clustermixer设计">2.1 ClusterMixer设计</h4>
<p>ClusterMixer是一种基于聚类的token混合器，其工作流程分为三个步骤：</p>
<ol>
<li>
<p><strong>聚类中心估计</strong>：</p>
<pre><code>给定数据点 X ∈ ℝ^(N×C)，通过对邻近块进行平均池化来估计聚类中心 C ∈ ℝ^(M×C)
</code></pre>
</li>
<li>
<p><strong>聚类分配</strong>：使用软聚类方法，允许数据点以不同程度的概率属于多个聚类<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><msub><mi>c</mi><mi>j</mi></msub><mo>∈</mo><mi>C</mi><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>∈</mo><mi>B</mi></mrow></msub><mo stretchy="false">(</mo><mi>α</mi><mo separator="true">⋅</mo><mi>D</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
a_i = Softmax_{c_j∈C, b_{i,j}∈B}(α·D(x_i, c_j) + b_{i,j})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09732em; vertical-align: -0.34732em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">C</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
其中，D是相似度度量，α是特征相似度的可学习标量，B ∈ ℝ^(N×M)参数化可学习的相对位置偏置。</p>
</li>
<li>
<p><strong>Token混合</strong>：先从数据点聚合特征，再将特征传播回数据点<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo separator="true">⋅</mo><msubsup><mi>c</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mtext>，其中</mtext><msubsup><mi>c</mi><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mi>j</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
g_i = ∑_{j=1}^M A_{i,j}·c'_j，其中 c'_j = (c_j + ∑_{i=1}^N A_{i,j}·x_i)/(1 + ∑_{i=1}^N A_{i,j})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，其中</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>F</mi><mi>C</mi><mo stretchy="false">(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
x'_i = x_i + FC(g_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04889em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">FC</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
其中FC是全连接层，用于保持token嵌入的特征维度。</p>
</li>
</ol>
<h4 id="层次聚类策略">2.2 层次聚类策略</h4>
<p>为了解决计算复杂度问题，HCFormer在不重叠的局部窗口内执行聚类操作，每个输入被分为S个窗口，每个窗口包含K个块。针对块级和窗口级混合，ClusterMixer有两种不同的数据点和聚类中心的公式化方式：</p>
<ol>
<li>
<p><strong>块级聚类</strong>：每个块作为数据点，聚类中心在每个局部窗口内估计，ClusterMixer在所有窗口中并行执行。</p>
</li>
<li>
<p><strong>窗口级聚类</strong>：每个窗口作为数据点，由其块的平均特征嵌入表示，聚类中心在整个输入上全局估计。</p>
</li>
</ol>
<p>这种设计将ClusterMixer的二次计算复杂度转变为线性复杂度。</p>
<h4 id="双曲层次聚类">2.3 双曲层次聚类</h4>
<p>论文使用双曲空间中的相似度估计来更好地捕捉抽象和复杂的语义关系。主要步骤包括：</p>
<ol>
<li>
<p><strong>定义双曲面</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>L</mi><mi>n</mi></msup><mo>=</mo><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="normal">R</mi><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>:</mo><mo stretchy="false">⟨</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><msub><mo stretchy="false">⟩</mo><mi>L</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>κ</mi><mo separator="true">,</mo><mi>κ</mi><mo>&gt;</mo><mn>0</mn></mrow><mtext>，其中</mtext><msub><mi>x</mi><mrow><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>=</mo><mtext>√</mtext><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>κ</mi><mo>+</mo><mo stretchy="false">⟨</mo><msub><mi>x</mi><mi>s</mi></msub><mi>p</mi><mi>a</mi><mi>c</mi><mi>e</mi><msup><mo stretchy="false">⟩</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
L^n = {x ∈ ℝ^{(n+1)} : ⟨x,x⟩_L = -1/κ, κ &gt; 0}，其中 x_{time} = √(1/κ + ⟨x_space⟩^2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.714392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord amsrm">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">⟩</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">−</span><span class="mord">1/</span><span class="mord mathnormal">κ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">κ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span><span class="mord cjk_fallback">，其中</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">im</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05em; vertical-align: -0.25em;"></span><span class="mord">√</span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">κ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span class="mclose"><span class="mclose">⟩</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
Lorentzian内积定义为：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">⟨</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><msub><mo stretchy="false">⟩</mo><mi>L</mi></msub><mo>:</mo><mo>=</mo><mo>−</mo><msub><mi>x</mi><mrow><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow></msub><mo separator="true">⋅</mo><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>+</mo><msubsup><mi>x</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>c</mi><mi>e</mi></mrow><mi>T</mi></msubsup><mo separator="true">⋅</mo><msub><mi>y</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>c</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
⟨x,y⟩_L := -x_{time}·y_{time} + x_{space}^T·y_{space}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose"><span class="mclose">⟩</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">im</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">im</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">ce</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p><strong>欧氏空间映射到双曲面</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><msubsup><mi>m</mi><mi>z</mi><mi>κ</mi></msubsup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mtext>√</mtext><mi>κ</mi><mtext>‖</mtext><mi>v</mi><msub><mtext>‖</mtext><mi>L</mi></msub><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>z</mi><mo>+</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><mtext>√</mtext><mi>κ</mi><mtext>‖</mtext><mi>v</mi><msub><mtext>‖</mtext><mi>L</mi></msub><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>v</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mtext>√</mtext><mi>κ</mi><mtext>‖</mtext><mi>v</mi><msub><mtext>‖</mtext><mi>L</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
expm_z^κ(v) = cosh(√κ‖v‖_L)·z + sinh(√κ‖v‖_L)·v/(√κ‖v‖_L)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.04398em;">z</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05em; vertical-align: -0.25em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord">√</span><span class="mord mathnormal">κ</span><span class="mord">‖</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mord"><span class="mord">‖</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.05em; vertical-align: -0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">inh</span><span class="mopen">(</span><span class="mord">√</span><span class="mord mathnormal">κ</span><span class="mord">‖</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mord"><span class="mord">‖</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">√</span><span class="mord mathnormal">κ</span><span class="mord">‖</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mord"><span class="mord">‖</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>L</mi></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><msubsup><mi>m</mi><mn>0</mn><mi>κ</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>c</mi><mi>L</mi></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><msubsup><mi>m</mi><mn>0</mn><mi>κ</mi></msubsup><mo stretchy="false">(</mo><msub><mi>c</mi><mi>E</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
x_L = expm_0^κ(x_E), c_L = expm_0^κ(c_E)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>双曲相似度估计</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>D</mi><mi>L</mi><mi>κ</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>L</mi></msub><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mtext>√</mtext><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>κ</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>c</mi><mi>o</mi><mi>s</mi><msup><mi>h</mi><mo stretchy="false">(</mo></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>x</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>L</mi></msub><msub><mo stretchy="false">⟩</mo><mi>L</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
D_L^κ(x_L, c_L) := √(1/κ)·cosh^(-1)(-⟨x_L, c_L⟩_L)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord">√</span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">κ</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">cos</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">⟩</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>ClusterMixer的重新公式化</strong>：<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>x</mi><mo>+</mo><mi>F</mi><mi>C</mi><mo stretchy="false">(</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msubsup><mi>g</mi><mi>L</mi><mi>W</mi></msubsup><mo separator="true">,</mo><msubsup><mi>g</mi><mi>E</mi><mi>P</mi></msubsup><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
x' = x + FC(Norm([g_L^W, g_E^P]))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.801892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.14133em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">FC</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mopen">([</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">]))</span></span></span></span></span></span><br>
其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>L</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">g_L^W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.11666em; vertical-align: -0.275331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示通过双曲相似度从窗口聚合的特征，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>E</mi><mi>P</mi></msubsup></mrow><annotation encoding="application/x-tex">g_E^P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.11666em; vertical-align: -0.275331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示通过欧氏相似度从块聚合的特征。</p>
</li>
</ol>
<h4 id="与之前方法的比较和优势">2.4 与之前方法的比较和优势</h4>
<p><strong>与传统视觉骨干网络相比</strong>：</p>
<ul>
<li><strong>可解释性</strong>：与卷积、自注意力或MLP等"黑盒"方法不同，ClusterMixer的聚类过程是可解释的</li>
<li><strong>计算效率</strong>：通过层次聚类策略，将二次复杂度降为线性复杂度</li>
<li><strong>灵活性</strong>：由于其非参数化和基于聚类的设计，ClusterMixer可以有效应用于各种下游任务</li>
</ul>
<p><strong>与现有聚类方法相比</strong>：</p>
<ul>
<li><strong>软聚类</strong>：相比CoC使用的硬聚类，软聚类允许在不同任务中构建更多聚类，提高性能</li>
<li><strong>相对位置偏置</strong>：有效帮助聚类算法建立关系依赖性</li>
<li><strong>双曲几何</strong>：利用双曲空间的特性更好地建模层次关系，而现有方法主要在欧氏空间中进行聚类</li>
</ul>
<p><strong>与Swin Transformer移位窗口相比</strong>：</p>
<ul>
<li>Swin的移位窗口机制只允许相邻窗口之间的本地化交互，仍受限于有限的感受野</li>
<li>HCFormer的层次聚类策略在块级和窗口级同时操作，能够更有效地捕获全局上下文信息</li>
</ul>
<h2 id="实验验证">实验验证</h2>
<h3 id="论文通过什么实验来验证所提出方法的有效性？实验是如何设计的？实验数据和结果如何？">3. 论文通过什么实验来验证所提出方法的有效性？实验是如何设计的？实验数据和结果如何？</h3>
<h4 id="图像分类实验">3.1 图像分类实验</h4>
<p><strong>数据集</strong>：ImageNet-1K，包含1.3M训练图像和50K验证图像，来自1K个常见类别。</p>
<p><strong>实验设置</strong>：</p>
<ul>
<li>使用Timm作为代码库，在4个A100 GPU上运行，批量大小为256</li>
<li>所有模型训练310个epoch，使用动量0.9和权重衰减0.05</li>
<li>学习率设为1e-3，使用余弦调度和5个预热epoch</li>
<li>数据增强：Mixup、CutMix、CutOut和RandAugment</li>
<li>评估指标：top-1分类准确率</li>
</ul>
<p><strong>结果</strong>：</p>
<ul>
<li>HCFormer-Small (16M参数) 超过了：
<ul>
<li>ResMLP-12：3.4% (79.9% vs. 76.6%)</li>
<li>PVT-Tiny：4.9% (79.9% vs. 75.1%)</li>
<li>ConvMixer-1024/12：2.2% (79.9% vs. 77.8%)</li>
</ul>
</li>
<li>HCFormer-Medium (33.7M参数) 超过了：
<ul>
<li>Swin-Tiny：1.1% (82.4% vs. 81.3%)</li>
<li>MLP-Mixer-B/16：6% (82.4% vs. 76.4%)</li>
</ul>
</li>
<li>与聚类型方法相比：HCFormer相比FEC在三种模型大小上分别提升了2.3%/1.8%/1.2%</li>
<li>最小变体HCFormer-Nano (5.1M参数) 也超过了CoC-Tiny 1.3%和FEC-Small 0.4%</li>
</ul>
<h4 id="语义分割实验">3.2 语义分割实验</h4>
<p><strong>数据集</strong>：ADE20K，包含20K训练图像和2K验证图像，来自150个语义类别。</p>
<p><strong>实验设置</strong>：</p>
<ul>
<li>使用mmsegmentation作为代码库，在4个A100 GPU上运行，批量大小为16</li>
<li>HCFormer作为骨干配备Semantic FPN进行语义分割</li>
<li>所有模型训练80k迭代，使用AdamW优化器</li>
<li>学习率初始为2e-4，多项式衰减(power=0.9)</li>
<li>骨干初始化为ImageNet预训练权重，新增层使用Xavier初始化</li>
<li>训练时随机尺度抖动（因子在[0.5, 2.0]）和512×512裁剪尺寸</li>
<li>推理时使用单一图像尺度，较短边为512像素</li>
<li>评估指标：平均交并比(mIoU)</li>
</ul>
<p><strong>结果</strong>：</p>
<ul>
<li>HCFormer相比同等参数量的CoC和FEC显著提高：
<ul>
<li>在19M参数量下：40.4% vs. 36.6%(CoC) vs. 37.7%(FEC)</li>
<li>在35M参数量下：43.3% vs. 40.2%(CoC) vs. 40.5%(FEC)</li>
</ul>
</li>
<li>HCFormer-Small性能与CoC-Medium/4和FEC-Large相当，但参数更少</li>
<li>HCFormer-Nano超过FEC-Small 1.5%，同时参数量减少0.3M</li>
</ul>
<h4 id="目标检测和实例分割实验">3.3 目标检测和实例分割实验</h4>
<p><strong>数据集</strong>：MS COCO 2017，包含118K训练图像和5K验证图像。</p>
<p><strong>实验设置</strong>：</p>
<ul>
<li>使用mmdetection作为代码库，在4个A100 GPU上运行，批量大小为16</li>
<li>HCFormer作为Mask R-CNN的骨干进行目标检测和实例分割</li>
<li>骨干初始化为ImageNet预训练权重，新增层使用Xavier初始化</li>
<li>所有模型训练12个epoch (1×调度)，使用AdamW优化器，初始学习率为1e-4</li>
<li>训练时图像调整大小，较短边为800像素，较长边≤1,333像素</li>
<li>推理时较短边也缩放到800像素</li>
<li>评估指标：平均精度(mAP)</li>
</ul>
<p><strong>结果</strong>：</p>
<ul>
<li>在34M模型尺度下，HCFormer超过了聚类型方法：
<ul>
<li>目标检测：38.7% vs. 37.2%(CoC) vs. 37.9%(FEC)</li>
<li>实例分割：36.0% vs. 35.4%(CoC) vs. 35.5%(FEC)</li>
</ul>
</li>
<li>HCFormer-Nano超过FEC-Small 0.4%AP_box和0.4%AP_mask，参数量更少</li>
<li>HCFormer-Medium达到40.9%AP_box和37.6%AP_mask，仅在实例分割上略逊于PVT-Small(0.1%)</li>
<li>HCFormer-Medium比CoC-Medium/49吞吐量高37%，计算效率更高</li>
</ul>
<h4 id="消融实验">3.4 消融实验</h4>
<p><strong>1. 层次聚类策略</strong>：</p>
<ul>
<li>移位窗口：top-1准确率72.7%，top-5准确率91.1%</li>
<li>层次聚类：top-1准确率73.4%，top-5准确率91.4%</li>
</ul>
<p><strong>2. 聚类几何空间</strong>：</p>
<ul>
<li>窗口(欧氏)+块(欧氏)：top-1 73.4%，top-5 91.4%</li>
<li>窗口(双曲)+块(双曲)：top-1 74.7%，top-5 92.3%</li>
<li>窗口(双曲)+块(欧氏)：top-1 75.0%，top-5 92.5%</li>
</ul>
<p><strong>3. 关键组件分析</strong>：</p>
<ul>
<li>基线：top-1 71.9%，mIoU 35.1%，AP_box 34.3%，AP_mask 32.7%</li>
<li>+层次聚类：top-1提高1.5%，mIoU提高1.2%，AP提高~2%</li>
<li>+双曲几何：top-1提高1.3%，mIoU提高0.9%，AP提高~1%</li>
<li>+相对位置：top-1提高0.6%，mIoU提高0.9%，AP提高~0.5%</li>
</ul>
<p><strong>4. 双曲空间曲率和窗口级聚类数量</strong>：</p>
<ul>
<li>曲率变化(0.1，1.0，10.0)对性能影响较小</li>
<li>窗口级聚类中心数量为16时性能最优</li>
</ul>
<p><strong>5. 聚类可视化</strong>：</p>
<ul>
<li>可视化结果显示HCFormer能够捕获token之间的内在关系模式</li>
<li>聚类结果从粗到细，随着块的合并逐渐形成更大的聚类，最终形成16个聚类</li>
</ul>
<h2 id="研究方向与挑战">研究方向与挑战</h2>
<h3 id="未来在该研究方向上还有哪些值得进一步探索的问题和挑战？这可能催生出什么新的技术和投资机会？">4. 未来在该研究方向上还有哪些值得进一步探索的问题和挑战？这可能催生出什么新的技术和投资机会？</h3>
<p><strong>值得探索的问题和挑战</strong>：</p>
<ol>
<li>
<p><strong>聚类算法的扩展性和效率</strong>：</p>
<ul>
<li>开发更强大、时间效率更高的聚类技术，以增强模型的扩展性</li>
<li>研究如何在更大规模的数据集和更深的网络结构中有效应用聚类方法</li>
</ul>
</li>
<li>
<p><strong>双曲空间的稳定性和优化</strong>：</p>
<ul>
<li>解决双曲几何中的数值不稳定性问题</li>
<li>开发更高效的双曲空间操作，减少计算开销</li>
</ul>
</li>
<li>
<p><strong>域适应与鲁棒性</strong>：</p>
<ul>
<li>解决在不同分辨率输入时聚类算法的稳定性问题</li>
<li>增强模型对分布外或噪声数据的鲁棒性，这些可能会干扰中心估计和聚类分配</li>
</ul>
</li>
</ol>
<p><strong>潜在的新技术和投资机会</strong>：</p>
<ol>
<li>
<p><strong>可解释AI工具和框架</strong>：</p>
<ul>
<li>基于聚类的可视化工具，帮助理解和解释模型决策</li>
<li>在医疗诊断、自动驾驶等需要高透明度的领域应用</li>
</ul>
</li>
<li>
<p><strong>高效边缘计算</strong>：</p>
<ul>
<li>开发针对资源受限设备的轻量级但高性能的视觉模型</li>
<li>基于层次聚类的模型压缩和加速技术</li>
</ul>
</li>
<li>
<p><strong>科学研究应用</strong>：</p>
<ul>
<li>在蛋白质设计、分子动力学、化学合成等科学领域应用，利用其可解释性支持科学发现</li>
<li>为生物医学图像分析提供更可靠的自动化工具</li>
</ul>
</li>
</ol>
<h2 id="不足与局限">不足与局限</h2>
<h3 id="这篇论文还存在哪些不足及缺失？又有哪些需要进一步验证和存疑的？">5. 这篇论文还存在哪些不足及缺失？又有哪些需要进一步验证和存疑的？</h3>
<p><strong>论文存在的不足和缺失</strong>：</p>
<ol>
<li>
<p><strong>对超参数探索不够全面</strong>：</p>
<ul>
<li>没有系统地探索聚类数量、窗口大小等超参数配置</li>
<li>仅对几个关键参数进行了有限的消融实验，可能未达到最优性能</li>
</ul>
</li>
<li>
<p><strong>理论分析不足</strong>：</p>
<ul>
<li>缺乏对为什么双曲空间更适合视觉层次表示的深入理论分析</li>
<li>对聚类过程如何影响模型泛化能力的理论解释不足</li>
</ul>
</li>
<li>
<p><strong>扩展性研究有限</strong>：</p>
<ul>
<li>仅在有限的任务和数据集上进行了评估</li>
<li>未探索在极大规模数据集上的表现，如ImageNet-22K或JFT-300M</li>
</ul>
</li>
<li>
<p><strong>与最新方法比较不完整</strong>：</p>
<ul>
<li>没有与一些最近的先进骨干网络进行比较，如ConvNeXt、MaxViT等</li>
<li>比较的双曲视觉模型主要集中在CLIP类方法上，缺少与其他双曲视觉骨干网络的比较</li>
</ul>
</li>
</ol>
<p><strong>需要进一步验证和存疑的问题</strong>：</p>
<ol>
<li>
<p><strong>双曲聚类的实际贡献</strong>：</p>
<ul>
<li>双曲和欧氏几何在性能上的差异可能部分来自于参数量的差异，而非几何本身</li>
<li>模型性能是否真正受益于双曲空间的层次建模能力需要更严格的控制实验</li>
</ul>
</li>
<li>
<p><strong>计算复杂度与性能的权衡</strong>：</p>
<ul>
<li>论文声称在保持线性复杂度的同时提高了性能，但缺少详细的理论分析</li>
<li>与其他线性复杂度方法（如线性注意力）的系统比较不足</li>
</ul>
</li>
<li>
<p><strong>可解释性的实际价值</strong>：</p>
<ul>
<li>论文强调模型的可解释性，但没有具体展示如何利用这种可解释性解决实际问题</li>
<li>缺少定量评估模型可解释性的实验</li>
</ul>
</li>
<li>
<p><strong>长期训练稳定性</strong>：</p>
<ul>
<li>缺少关于模型在更长训练周期下的稳定性分析</li>
<li>没有探讨潜在的过拟合问题，特别是在聚类中心数量增加时</li>
</ul>
</li>
</ol>
<h2 id="创新与启发">创新与启发</h2>
<h3 id="我希望从这篇论文中找一些拿来即用的创新想法，我应该从这篇论文中重点学什么？有哪些启发？你认为我还需要补充了解哪些背景知识？">6. 我希望从这篇论文中找一些拿来即用的创新想法，我应该从这篇论文中重点学什么？有哪些启发？你认为我还需要补充了解哪些背景知识？</h3>
<p><strong>拿来即用的创新想法</strong>：</p>
<ol>
<li>
<p><strong>双几何空间协同</strong>：在同一模型中结合欧氏空间和双曲空间的优势，针对不同层级的任务使用不同的几何空间</p>
<ul>
<li>欧氏空间处理细粒度、计算密集的局部关系</li>
<li>双曲空间处理抽象、计算高效的全局关系</li>
</ul>
</li>
<li>
<p><strong>层次聚类策略</strong>：通过在不同尺度上应用聚类操作，在保持计算效率的同时捕获全局上下文</p>
<ul>
<li>局部窗口内的块级聚类</li>
<li>全局范围的窗口级聚类</li>
</ul>
</li>
<li>
<p><strong>软聚类机制</strong>：使用可学习的相对位置偏置和软分配机制，允许数据点属于多个聚类</p>
<ul>
<li>相比硬聚类，这种方法能够在不同任务中构建更多聚类，提高性能</li>
</ul>
</li>
</ol>
<p><strong>重点学习内容与启发</strong>：</p>
<ol>
<li>
<p><strong>可解释性与性能的平衡</strong>：</p>
<ul>
<li>HCFormer展示了如何在不牺牲模型性能的情况下增强可解释性</li>
<li>这种平衡对于构建可靠且透明的AI系统至关重要</li>
</ul>
</li>
<li>
<p><strong>几何空间对表示学习的影响</strong>：</p>
<ul>
<li>选择合适的几何空间对于有效建模数据结构至关重要</li>
<li>不同任务和数据特性可能需要不同的几何表示</li>
</ul>
</li>
<li>
<p><strong>计算效率的优化策略</strong>：</p>
<ul>
<li>通过层次设计将二次计算复杂度转换为线性复杂度</li>
<li>在维持性能的同时提高计算效率的方法</li>
</ul>
</li>
</ol>
<p><strong>需要补充的背景知识</strong>：</p>
<ol>
<li>
<p><strong>双曲几何基础</strong>：</p>
<ul>
<li>双曲空间的定义、特性及其与欧氏空间的区别</li>
<li>Lorentz模型、Poincaré球模型等不同的双曲空间表示</li>
<li>双曲空间中的距离计算和映射操作</li>
</ul>
</li>
<li>
<p><strong>聚类算法</strong>：</p>
<ul>
<li>基本聚类方法（K-means、EM算法等）的原理和特性</li>
<li>软聚类与硬聚类的区别及适用场景</li>
<li>聚类算法在视觉任务中的应用</li>
</ul>
</li>
<li>
<p><strong>视觉骨干网络架构</strong>：</p>
<ul>
<li>ConvNets、ViTs、MLP-Mixer等主流骨干网络的设计原则</li>
<li>token混合机制及其在不同架构中的实现</li>
<li>MetaFormer等通用架构范式的理念</li>
</ul>
</li>
<li>
<p><strong>表示学习中的层次建模</strong>：</p>
<ul>
<li>视觉数据中的层次结构特性</li>
<li>现有模型如何隐式或显式地捕获层次信息</li>
<li>层次表示在下游任务中的重要性</li>
</ul>
</li>
</ol>
<p>通过这篇论文，我们可以看到，虽然深度学习通常被视为"黑盒"，但通过重新审视经典方法如聚类，并将其与现代几何理论如双曲空间相结合，我们可以构建既高效又可解释的模型。这种思路不仅可以应用于视觉表示学习，也可以扩展到其他领域，如自然语言处理、多模态学习等，为可解释AI研究提供新的思路。</p>

