---


---

<h1 id="《all-tokens-matter-token-labeling-for-training-better-vision-transformers》深度解读">《All Tokens Matter: Token Labeling for Training Better Vision Transformers》深度解读</h1>
<h2 id="研究目标与问题意义">1. 研究目标与问题意义</h2>
<h3 id="研究目标">研究目标</h3>
<ul>
<li><strong>解决ViT局部信息缺失问题</strong>：传统视觉Transformer（ViT）仅依赖<strong>Class Token</strong>进行分类，忽略了编码局部信息的Patch Tokens，导致模型易偏向非泛化模式。</li>
<li><strong>提升ViT泛化能力</strong>：通过密集监督增强模型对局部细节的捕捉，尤其是下游密集预测任务（如语义分割）的迁移性能。</li>
</ul>
<h3 id="问题意义">问题意义</h3>
<ul>
<li><strong>学术价值</strong>：首次证明<strong>密集监督</strong>对ViT图像分类的有效性，填补了ViT局部信息利用的空白。</li>
<li><strong>产业影响</strong>：优化后的ViT模型可应用于自动驾驶（图像分割）、医疗影像（病灶检测）等高精度视觉任务，降低模型部署成本（如LV-ViT-L仅150M参数即达86.4% ImageNet精度）。</li>
</ul>
<h2 id="模型方法与创新思路">2. 模型方法与创新思路</h2>
<h3 id="核心创新：token-labeling">核心创新：Token Labeling</h3>
<p>论文提出<strong>Token Labeling</strong>，为每个Patch Token提供位置特定的监督信号，结合Class Token的全局监督，形成混合损失函数。</p>
<h4 id="（1）vit传统损失函数">（1）ViT传统损失函数</h4>
<p>传统ViT仅使用Class Token计算损失：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mtext>cls</mtext></msub><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mtext>cls</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>cls</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L_{\text{cls}} = H(X_{\text{cls}}, y_{\text{cls}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>其中：</p>
<ul>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mtext>cls</mtext></msub></mrow><annotation encoding="application/x-tex">X_{\text{cls}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：最后一层Transformer输出的Class Token；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mtext>cls</mtext></msub></mrow><annotation encoding="application/x-tex">y_{\text{cls}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：图像全局标签；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(\cdot,\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span>：交叉熵损失。</li>
</ul>
<blockquote>
<p>“the class token from the output tokens of the last transformer block is usually selected and sent into a linear layer for the classification score prediction.”</p>
</blockquote>
<h4 id="（2）token-labeling损失函数">（2）Token Labeling损失函数</h4>
<p>Token Labeling为每个Patch Token添加局部监督：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mtext>tl</mtext></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>H</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L_{\text{tl}} = \frac{1}{N} \sum_{i=1}^N H(X_i, y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tl</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>总损失函数：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mtext>total</mtext></msub><mo>=</mo><msub><mi>L</mi><mtext>cls</mtext></msub><mo>+</mo><mi>β</mi><mo>⋅</mo><msub><mi>L</mi><mtext>tl</mtext></msub></mrow><annotation encoding="application/x-tex">L_{\text{total}} = L_{\text{cls}} + \beta \cdot L_{\text{tl}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cls</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.05278em;">β</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tl</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中：</p>
<ul>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span>：Patch Token数量；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>​：第i个Patch Token的输出；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>​：由机器标注器（如NFNet-F6）生成的位置特定标签；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.05278em;">β</span></span></span></span></span>：权重系数（论文设为0.5）。</li>
</ul>
<h4 id="（3）mixtoken：token层面的数据增强">（3）MixToken：Token层面的数据增强</h4>
<p>针对CutMix导致Patch内内容混合的问题，论文提出<strong>MixToken</strong>，在Token层面进行混合：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo>=</mo><msub><mi>T</mi><mn>1</mn></msub><mo>⊙</mo><mi>M</mi><mo>+</mo><msub><mi>T</mi><mn>2</mn></msub><mo>⊙</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{T} = T_1 \odot M + T_2 \odot (1-M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.94677em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mclose">)</span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mo>=</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>⊙</mo><mi>M</mi><mo>+</mo><msub><mi>Y</mi><mn>2</mn></msub><mo>⊙</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{Y} = Y_1 \odot M + Y_2 \odot (1-M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.94677em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>其中：</p>
<ul>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1/T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：两张图像的Token序列；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span></span></span></span></span>：二进制Mask（同CutMix生成方式）；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">⊙</span></span></span></span></span>：元素级乘法。</li>
</ul>
<p><strong>MixToken vs CutMix对比</strong>：</p>

<table>
<thead>
<tr>
<th>方法</th>
<th>操作层面</th>
<th>核心优势</th>
</tr>
</thead>
<tbody>
<tr>
<td>CutMix</td>
<td>图像层面</td>
<td>增强数据多样性</td>
</tr>
<tr>
<td>MixToken</td>
<td>Token层面</td>
<td>避免Patch内混合内容，标签干净</td>
</tr>
</tbody>
</table><h2 id="实验验证与结果分析">3. 实验验证与结果分析</h2>
<h3 id="关键实验结果">关键实验结果</h3>
<ul>
<li><strong>ImageNet分类性能</strong>：
<ul>
<li>LV-ViT-S（26M参数）：83.3% Top-1精度（224×224），提升至84.4%（384×384）；</li>
<li>LV-ViT-L（150M参数）：86.4% Top-1精度（512×512），为当时最小规模达86%精度的模型。</li>
</ul>
</li>
<li><strong>语义分割迁移</strong>：
<ul>
<li>LV-ViT-S+FCN：mIoU从46.1%提升至47.2%（ADE20K数据集）；</li>
<li>LV-ViT-L+UperNet：mIoU达51.8%，为无ImageNet-22K预训练的最优结果。</li>
</ul>
</li>
<li><strong>鲁棒性验证</strong>：Token Labeling对DeiT、T2T-ViT等ViT变体均有0.5-1.5%的精度提升。</li>
</ul>
<h2 id="未来研究方向与应用前景">4. 未来研究方向与应用前景</h2>
<h3 id="未来方向">未来方向</h3>
<ul>
<li><strong>扩展到更多视觉任务</strong>：探索Token Labeling在目标检测（如DETR）、视频理解（如TimeSformer）中的应用；</li>
<li><strong>优化标注器效率</strong>：降低机器标注器（如NFNet）的计算成本，探索轻量级标注方案；</li>
<li><strong>自适应Token权重</strong>：动态调整不同Patch Token的监督权重，进一步提升模型性能。</li>
</ul>
<h3 id="应用前景">应用前景</h3>
<ul>
<li><strong>自动驾驶</strong>：高精度语义分割助力道路场景理解；</li>
<li><strong>医疗影像</strong>：密集监督提升病灶区域定位精度；</li>
<li><strong>边缘设备部署</strong>：小参数模型（如LV-ViT-T 8.5M）可在移动端高效运行。</li>
</ul>
<h2 id="论文不足与存疑之处">5. 论文不足与存疑之处</h2>
<ul>
<li><strong>依赖预训练标注器</strong>：Token Labeling需要NFNet等预训练模型生成标签，增加了前置成本；</li>
<li><strong>MixToken局限性</strong>：仅支持二进制Mask混合，未探索更灵活的混合策略；</li>
<li><strong>泛化性待验证</strong>：实验主要集中在ImageNet和ADE20K，其他数据集（如COCO）的表现需进一步测试。</li>
</ul>
<h2 id="创新启发与背景知识补充">6. 创新启发与背景知识补充</h2>
<h3 id="创新启发">创新启发</h3>
<ul>
<li><strong>密集监督的价值</strong>：打破“仅用Class Token”的思维定式，利用所有Token的局部信息提升模型泛化性；</li>
<li><strong>Token层面增强</strong>：MixToken证明在Token层面进行数据增强可有效避免图像层面的缺陷；</li>
<li><strong>跨任务迁移</strong>：密集监督天然适合下游密集预测任务，为ViT的多任务学习提供新思路。</li>
</ul>
<h3 id="背景知识补充">背景知识补充</h3>
<ul>
<li><strong>ViT基础</strong>：需了解Patch Embedding、Class Token、Transformer Blocks的核心原理；</li>
<li><strong>数据增强</strong>：掌握CutMix、MixUp等传统增强方法的优缺点；</li>
<li><strong>语义分割框架</strong>：熟悉FCN、UperNet等分割模型的基本结构，理解预训练模型的迁移机制。</li>
</ul>
<p><strong>总结</strong>：本文通过Token Labeling和MixToken两大创新，有效解决了ViT局部信息缺失的问题，为视觉Transformer的训练提供了新范式。其核心思想——<strong>利用所有Token的密集监督</strong>——不仅提升了分类性能，还为下游任务迁移奠定了基础，具有重要的学术和产业价值。</p>
<h1 id="《enhancing-transformer-based-vision-models-addressing-feature-map-anomalies-through-novel-optimization-strategies》深度解读">《Enhancing Transformer-Based Vision Models: Addressing Feature Map Anomalies Through Novel Optimization Strategies》深度解读</h1>
<h2 id="研究目标与问题意义-1">1. 研究目标与问题意义</h2>
<h3 id="研究目标-1">研究目标</h3>
<ul>
<li><strong>解决ViT特征图异常问题</strong>：消除Vision Transformers（ViTs）中背景区域的高范数token、结构化噪声等异常，提升模型对局部细节的捕捉能力。</li>
<li><strong>轻量级优化策略</strong>：提出无需大幅修改架构的端到端训练方法，避免寄存器tokens（Registers[4]）或后处理 denoising（DVT[5]）的额外开销。</li>
</ul>
<h3 id="问题意义-1">问题意义</h3>
<ul>
<li><strong>学术价值</strong>：首次将前端token增强与中端层间滤波结合，填补了ViT特征图异常端到端优化的空白。</li>
<li><strong>产业影响</strong>：优化后的模型在语义分割（ADE20k）、深度估计等下游任务性能提升显著，可直接应用于自动驾驶、医疗影像等高精度场景，降低部署成本。</li>
</ul>
<h2 id="模型方法与创新思路-1">2. 模型方法与创新思路</h2>
<p>论文提出<strong>Structured Token Augmentation (STA)</strong> 和 <strong>Adaptive Noise Filtering (ANF)</strong> 两大核心策略，均为轻量级且架构无关。</p>
<h3 id="（1）structured-token-augmentation（sta）">（1）Structured Token Augmentation（STA）</h3>
<p><strong>核心思想</strong>：对低方差的背景patch注入空间噪声，减少冗余token，增强局部特征多样性。<br>
公式定义：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>i</mi></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>α</mi><mo>⋅</mo><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{x}_i = x_i + \alpha \cdot M(x_i) \cdot \epsilon_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.81786em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal">x</span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>参数解释：</p>
<ul>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：原始patch token；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">[</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>&lt;</mo><mi>τ</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M(x_i) = I[Var(x_i) &lt; \tau]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mopen">[</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mclose">]</span></span></span></span></span>：二进制mask，仅对局部方差小于阈值\tauτ的patch生效；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon_i \sim N(0,\sigma^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>：高斯噪声；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>：噪声强度系数。</li>
</ul>
<blockquote>
<p>“Structured Token Augmentation (STA): A method for enriching token diversity by injecting spatially-aware perturbations during the tokenization process, designed to reduce redundancy in background tokens.”</p>
</blockquote>
<p><strong>优势</strong>：相比寄存器tokens（需额外参数存储全局信息），STA在tokenization阶段直接优化，无额外内存开销；相比DVT的后处理，STA是端到端训练的一部分，无需离线计算。</p>
<h3 id="（2-adaptive-noise-filtering-anf">（2 Adaptive Noise Filtering (ANF)</h3>
<p><strong>核心思想</strong>：在ViT层间加入轻量级卷积+门控机制，实时抑制非语义激活。<br>
公式定义：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>T</mi><mo>^</mo></mover><mi>i</mi></msub><mo>=</mo><mtext>LayerNorm</mtext><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>+</mo><mtext>Conv1D</mtext><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mtext>Gate</mtext><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{T}_i = \text{LayerNorm}(T_i + \text{Conv1D}(T_i) \cdot \text{Gate}(T_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09677em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">LayerNorm</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Conv1D</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Gate</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span></span></p>
<p>其中门控函数：</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Gate</mtext><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>W</mi><mo>⋅</mo><msub><mi>T</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Gate}(T_i) = \sigma(W \cdot T_i + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Gate</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">W</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></span></p>
<p>参数解释：</p>
<ul>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>​：当前层token序列；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Conv1D</mtext></mrow><annotation encoding="application/x-tex">\text{Conv1D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">Conv1D</span></span></span></span></span></span>：1D卷积提取局部特征；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span></span></span></span></span>：sigmoid函数生成门控权重，过滤噪声；</li>
<li><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LayerNorm</mtext></mrow><annotation encoding="application/x-tex">\text{LayerNorm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord text"><span class="mord">LayerNorm</span></span></span></span></span></span>：层归一化保持稳定性。</li>
</ul>
<blockquote>
<p>“Adaptive Noise Filtering (ANF): A lightweight, learnable filtering mechanism integrated into transformer layers to suppress non-semantic activations in real time.”</p>
</blockquote>
<p><strong>优势</strong>：相比DVT的两阶段后处理，ANF是端到端训练的一部分，计算开销仅增加5%；相比寄存器tokens的静态存储，ANF动态过滤噪声，适应性更强。</p>
<h3 id="方法对比表格">方法对比表格</h3>

<table>
<thead>
<tr>
<th>方法</th>
<th>位置</th>
<th>开销</th>
<th>训练方式</th>
<th>核心优势</th>
</tr>
</thead>
<tbody>
<tr>
<td>Registers[4]</td>
<td>输入层</td>
<td>2%-6%</td>
<td>离线</td>
<td>分离全局信息与局部token</td>
</tr>
<tr>
<td>DVT[5]</td>
<td>输出后处理</td>
<td>高</td>
<td>离线</td>
<td>消除结构化噪声</td>
</tr>
<tr>
<td>STA+ANF（本文）</td>
<td>输入+层间</td>
<td>&lt;5%</td>
<td>端到端</td>
<td>轻量级、动态优化、无额外标注</td>
</tr>
</tbody>
</table><h3 id="模型流程">模型流程</h3>
<pre class=" language-mermaid"><svg id="mermaid-svg-tE0dIMhkL5OQcPg9" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="57.71875" style="max-width: 1345.25px;" viewBox="0 0 1345.25 57.71875"><style>#mermaid-svg-tE0dIMhkL5OQcPg9{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-tE0dIMhkL5OQcPg9 .error-icon{fill:#552222;}#mermaid-svg-tE0dIMhkL5OQcPg9 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-tE0dIMhkL5OQcPg9 .marker{fill:#666;stroke:#666;}#mermaid-svg-tE0dIMhkL5OQcPg9 .marker.cross{stroke:#666;}#mermaid-svg-tE0dIMhkL5OQcPg9 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-tE0dIMhkL5OQcPg9 .cluster-label text{fill:#333;}#mermaid-svg-tE0dIMhkL5OQcPg9 .cluster-label span{color:#333;}#mermaid-svg-tE0dIMhkL5OQcPg9 .label text,#mermaid-svg-tE0dIMhkL5OQcPg9 span{fill:#000000;color:#000000;}#mermaid-svg-tE0dIMhkL5OQcPg9 .node rect,#mermaid-svg-tE0dIMhkL5OQcPg9 .node circle,#mermaid-svg-tE0dIMhkL5OQcPg9 .node ellipse,#mermaid-svg-tE0dIMhkL5OQcPg9 .node polygon,#mermaid-svg-tE0dIMhkL5OQcPg9 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .node .label{text-align:center;}#mermaid-svg-tE0dIMhkL5OQcPg9 .node.clickable{cursor:pointer;}#mermaid-svg-tE0dIMhkL5OQcPg9 .arrowheadPath{fill:#333333;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-tE0dIMhkL5OQcPg9 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-tE0dIMhkL5OQcPg9 .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-tE0dIMhkL5OQcPg9 .cluster text{fill:#333;}#mermaid-svg-tE0dIMhkL5OQcPg9 .cluster span{color:#333;}#mermaid-svg-tE0dIMhkL5OQcPg9 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-tE0dIMhkL5OQcPg9:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-tE0dIMhkL5OQcPg9 flowchart-v2{fill:apa;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M87,28.859375L91.16666666666667,28.859375C95.33333333333333,28.859375,103.66666666666667,28.859375,112,28.859375C120.33333333333333,28.859375,128.66666666666666,28.859375,132.83333333333334,28.859375L137,28.859375" id="L-A-B" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M286.34375,28.859375L290.5104166666667,28.859375C294.6770833333333,28.859375,303.0104166666667,28.859375,311.34375,28.859375C319.6770833333333,28.859375,328.0104166666667,28.859375,332.1770833333333,28.859375L336.34375,28.859375" id="L-B-C" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M539.234375,28.859375L543.4010416666666,28.859375C547.5677083333334,28.859375,555.9010416666666,28.859375,564.234375,28.859375C572.5677083333334,28.859375,580.9010416666666,28.859375,585.0677083333334,28.859375L589.234375,28.859375" id="L-C-D" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M683.296875,28.859375L687.4635416666666,28.859375C691.6302083333334,28.859375,699.9635416666666,28.859375,708.296875,28.859375C716.6302083333334,28.859375,724.9635416666666,28.859375,729.1302083333334,28.859375L733.296875,28.859375" id="L-D-E" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M891.4375,28.859375L895.6041666666666,28.859375C899.7708333333334,28.859375,908.1041666666666,28.859375,916.4375,28.859375C924.7708333333334,28.859375,933.1041666666666,28.859375,937.2708333333334,28.859375L941.4375,28.859375" id="L-E-F" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1061.21875,28.859375L1065.3854166666667,28.859375C1069.5520833333333,28.859375,1077.8854166666667,28.859375,1086.21875,28.859375C1094.5520833333333,28.859375,1102.8854166666667,28.859375,1107.0520833333333,28.859375L1111.21875,28.859375" id="L-F-G" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1240.25,28.859375L1244.4166666666667,28.859375C1248.5833333333333,28.859375,1256.9166666666667,28.859375,1265.25,28.859375C1273.5833333333333,28.859375,1281.9166666666667,28.859375,1286.0833333333333,28.859375L1290.25,28.859375" id="L-G-H" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-A-42" transform="translate(47.5, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-39.5" y="-20.859375" width="79" height="41.71875"></rect><g class="label" style="" transform="translate(-32, -13.359375)"><foreignObject width="64" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">输入图像</span></div></foreignObject></g></g><g class="node default default" id="flowchart-B-43" transform="translate(211.671875, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-74.671875" y="-20.859375" width="149.34375" height="41.71875"></rect><g class="label" style="" transform="translate(-67.171875, -13.359375)"><foreignObject width="134.34375" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Patch Tokenization</span></div></foreignObject></g></g><g class="node default default" id="flowchart-C-45" transform="translate(437.7890625, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-101.4453125" y="-20.859375" width="202.890625" height="41.71875"></rect><g class="label" style="" transform="translate(-93.9453125, -13.359375)"><foreignObject width="187.890625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">STA: 低方差patch注入噪声</span></div></foreignObject></g></g><g class="node default default" id="flowchart-D-47" transform="translate(636.265625, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-47.03125" y="-20.859375" width="94.0625" height="41.71875"></rect><g class="label" style="" transform="translate(-39.53125, -13.359375)"><foreignObject width="79.0625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">ViT Block 1</span></div></foreignObject></g></g><g class="node default default" id="flowchart-E-49" transform="translate(812.3671875, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-79.0703125" y="-20.859375" width="158.140625" height="41.71875"></rect><g class="label" style="" transform="translate(-71.5703125, -13.359375)"><foreignObject width="143.140625" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">ANF: 卷积+门控滤波</span></div></foreignObject></g></g><g class="node default default" id="flowchart-F-51" transform="translate(1001.328125, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-59.890625" y="-20.859375" width="119.78125" height="41.71875"></rect><g class="label" style="" transform="translate(-52.390625, -13.359375)"><foreignObject width="104.78125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">ViT Block 2...L</span></div></foreignObject></g></g><g class="node default default" id="flowchart-G-53" transform="translate(1175.734375, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-64.515625" y="-20.859375" width="129.03125" height="41.71875"></rect><g class="label" style="" transform="translate(-57.015625, -13.359375)"><foreignObject width="114.03125" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">分类头 / 解码器</span></div></foreignObject></g></g><g class="node default default" id="flowchart-H-55" transform="translate(1313.75, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-23.5" y="-20.859375" width="47" height="41.71875"></rect><g class="label" style="" transform="translate(-16, -13.359375)"><foreignObject width="32" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">输出</span></div></foreignObject></g></g></g></g></g></svg></pre>
<h2 id="实验验证与结果分析-1">3. 实验验证与结果分析</h2>
<h3 id="实验设计">实验设计</h3>
<ul>
<li><strong>数据集</strong>：ImageNet（分类）、ADE20k（分割）、NYUv2（深度估计）；</li>
<li><strong>基线</strong>：ViT-B/16；</li>
<li><strong>对比组</strong>：基线、STA、ANF、STA+ANF。</li>
</ul>
<h3 id="关键结果">关键结果</h3>

<table>
<thead>
<tr>
<th>Model Variant</th>
<th>ImageNet Acc (%)</th>
<th>ADE20k mIoU (%)</th>
<th>NYUv2 Rel Error</th>
</tr>
</thead>
<tbody>
<tr>
<td>Baseline ViT-B/16</td>
<td>81.4</td>
<td>41.2</td>
<td>0.185</td>
</tr>
<tr>
<td>+ ANF</td>
<td>82.3</td>
<td>42.7</td>
<td>0.168</td>
</tr>
</tbody>
</table><p><strong>结论</strong>：STA+ANF组合性能最优，比基线提升1.6%分类准确率、2.3%分割mIoU，深度估计误差降低14%；且计算开销仅增加不到5%。</p>
<h2 id="未来研究方向与应用前景-1">4. 未来研究方向与应用前景</h2>
<h3 id="未来方向-1">未来方向</h3>
<ul>
<li><strong>扩展到其他架构</strong>：将STA+ANF应用于Vision Mamba[6]、CLIP等模型，验证跨架构泛化性；</li>
<li><strong>自适应参数优化</strong>：动态调整STA的\tauτ（方差阈值）和ANF的门控权重，提升鲁棒性；</li>
<li><strong>跨模态扩展</strong>：将STA的空间噪声增强扩展到文本token，优化图文跨模态模型。</li>
</ul>
<h3 id="应用前景-1">应用前景</h3>
<ul>
<li><strong>自动驾驶</strong>：提升语义分割（ADE20k mIoU43.5%）和深度估计精度，助力道路场景理解；</li>
<li><strong>医疗影像</strong>：消除病灶区域的噪声干扰，提升CT/MRI图像的病灶检测准确率；</li>
<li><strong>边缘设备</strong>：轻量级设计（&lt;5%开销）可直接部署于移动端，支持实时视觉任务。</li>
</ul>
<h2 id="论文不足与存疑之处-1">5. 论文不足与存疑之处</h2>
<ul>
<li><strong>参数敏感性</strong>：STA的\tauτ和\alphaα依赖人工调优，未探索自适应调整策略；</li>
<li><strong>极端场景验证</strong>：未测试超小（64×64）或超大（1024×1024）分辨率下的性能；</li>
<li><strong>跨数据集泛化</strong>：实验集中于标准数据集，未验证在低光照、模糊图像等复杂场景的鲁棒性。</li>
</ul>
<h2 id="创新启发与背景知识补充-1">6. 创新启发与背景知识补充</h2>
<h3 id="创新启发-1">创新启发</h3>
<ul>
<li><strong>轻量级优化思路</strong>：前端token增强+中端层间滤波的组合，避免大幅修改架构；</li>
<li><strong>动态噪声抑制</strong>：ANF的门控机制可实时过滤非语义激活，比后处理更高效；</li>
<li><strong>无额外标注</strong>：STA无需人工标注，直接利用patch方差自动识别背景区域。</li>
</ul>
<h3 id="背景知识补充-1">背景知识补充</h3>
<ul>
<li><strong>ViT基础</strong>：Patch Embedding、自注意力机制的原理；</li>
<li><strong>特征图异常</strong>：寄存器tokens[4]、DVT[5]的相关研究；</li>
<li><strong>轻量级卷积</strong>：1D卷积、门控机制在Transformer中的应用。</li>
</ul>
<p><strong>总结</strong>：本文通过STA和ANF两大轻量级策略，有效解决了ViT特征图异常问题，端到端训练的设计使其易于部署，为ViT的优化提供了新范式。</p>

